<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>JS测试教程 | 8128's Blog</title><meta name="description" content="JavaScript程序测试"><meta name="keywords" content="tutorial,code,javascript"><meta name="author" content="8128,tty8128@outlook.com"><meta name="copyright" content="8128"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="/img/favicon.ico"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="crossorigin"/><link rel="preconnect" href="https://fonts.googleapis.com" crossorigin="crossorigin"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta name="twitter:card" content="summary"><meta name="twitter:title" content="JS测试教程"><meta name="twitter:description" content="JavaScript程序测试"><meta name="twitter:image" content="https://raw.githubusercontent.com/8128/PicGo/master/20200326135918.png"><meta property="og:type" content="article"><meta property="og:title" content="JS测试教程"><meta property="og:url" content="http://8128.me/2020/03/26/JS%E6%B5%8B%E8%AF%95%E6%95%99%E7%A8%8B/"><meta property="og:site_name" content="8128's Blog"><meta property="og:description" content="JavaScript程序测试"><meta property="og:image" content="https://raw.githubusercontent.com/8128/PicGo/master/20200326135918.png"><script src="https://cdn.jsdelivr.net/npm/js-cookie/dist/js.cookie.min.js"></script><script>var autoChangeMode = '1'
var t = Cookies.get("theme")
if (autoChangeMode == '1'){
  var isDarkMode = window.matchMedia("(prefers-color-scheme: dark)").matches
  var isLightMode = window.matchMedia("(prefers-color-scheme: light)").matches
  var isNotSpecified = window.matchMedia("(prefers-color-scheme: no-preference)").matches
  var hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

  if (t === undefined){
    if (isLightMode) activateLightMode()
    else if (isDarkMode) activateDarkMode()
    else if (isNotSpecified || hasNoSupport){
      console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
      var now = new Date()
      var hour = now.getHours()
      var isNight = hour < 6 || hour >= 18
      isNight ? activateDarkMode() : activateLightMode()
  }
  } else if (t == 'light') activateLightMode()
  else activateDarkMode()

} else if (autoChangeMode == '2'){
  now = new Date();
  hour = now.getHours();
  isNight = hour < 6 || hour >= 18
  if(t === undefined) isNight? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode() 
} else {
  if ( t == 'dark' ) activateDarkMode()
  else if ( t == 'light') activateLightMode()
}

function activateDarkMode(){
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null){
    document.querySelector('meta[name="theme-color"]').setAttribute('content','#000')
  }
}
function activateLightMode(){
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null){
  document.querySelector('meta[name="theme-color"]').setAttribute('content','#fff')
  }
}</script><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css"><link rel="canonical" href="http://8128.me/2020/03/26/JS%E6%B5%8B%E8%AF%95%E6%95%99%E7%A8%8B/"><link rel="prev" title="Mac多Java版本管理" href="http://8128.me/2020/03/26/Mac%E5%A4%9AJava%E7%89%88%E6%9C%AC%E7%AE%A1%E7%90%86/"><link rel="next" title="ES6特性笔记" href="http://8128.me/2020/03/25/ES6%E7%89%B9%E6%80%A7%E7%AC%94%E8%AE%B0/"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/disqusjs@1.2/dist/disqusjs.css"><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-158741918-1', 'auto');
ga('send', 'pageview');
</script><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容:${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"cookieDomain":"http://8128.me/","msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  bookmark: {
    message_prev: '按',
    message_next: '键将本页加入书签'
  },
  runtime_unit: '天',
  runtime: true,
  copyright: undefined,
  ClickShowText: undefined,
  medium_zoom: false,
  fancybox: true,
  Snackbar: {"bookmark":{"message_prev":"按","message_next":"键将本页加入书签"},"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#2d3035","position":"bottom-left"},
  baiduPush: false,
  highlightCopy: true,
  highlightLang: true,
  highlightShrink: 'false',
  isFontAwesomeV5: false,
  isPhotoFigcaption: false
  
}</script><script>var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isSidebar: true  
  }</script><noscript><style>
#page-header {
  opacity: 1
}
.justified-gallery img{
  opacity: 1
}
</style></noscript><meta name="generator" content="Hexo 4.2.0"></head><body><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="/img/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">39</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">标签</div><div class="length_num">21</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">分类</div><div class="length_num">10</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> Link</span></a></div></div></div></div><i class="fa fa-arrow-right on" id="toggle-sidebar" aria-hidden="true">     </i><div id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#为什么要写测试？"><span class="toc-text">为什么要写测试？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#测试的类型"><span class="toc-text">测试的类型</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#单元测试"><span class="toc-text">单元测试</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#其他测试类型"><span class="toc-text">其他测试类型</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#开发模式"><span class="toc-text">开发模式</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#TDD"><span class="toc-text">TDD</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#BDD"><span class="toc-text">BDD</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#BDD术语"><span class="toc-text">BDD术语</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#断言"><span class="toc-text">断言</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Mocha-js"><span class="toc-text">Mocha.js</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#概述"><span class="toc-text">概述</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#浏览器测试"><span class="toc-text">浏览器测试</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#命令行测试"><span class="toc-text">命令行测试</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#mocha-opts"><span class="toc-text">mocha.opts</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#生成规格文件"><span class="toc-text">生成规格文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#测试脚本的写法"><span class="toc-text">测试脚本的写法</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Promise的测试"><span class="toc-text">Promise的测试</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#模拟数据"><span class="toc-text">模拟数据</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#覆盖率"><span class="toc-text">覆盖率</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#WebDriver"><span class="toc-text">WebDriver</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#定制测试环境"><span class="toc-text">定制测试环境</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#操作浏览器的方法"><span class="toc-text">操作浏览器的方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#网页元素的定位"><span class="toc-text">网页元素的定位</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#网页元素的方法"><span class="toc-text">网页元素的方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#页面跳转的方法"><span class="toc-text">页面跳转的方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#cookie的方法"><span class="toc-text">cookie的方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#浏览器窗口的方法"><span class="toc-text">浏览器窗口的方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#弹出窗口"><span class="toc-text">弹出窗口</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#鼠标和键盘的方法"><span class="toc-text">鼠标和键盘的方法</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#参考链接"><span class="toc-text">参考链接</span></a></li></ol></div></div></div><div id="body-wrap"><div class="post-bg" id="nav" style="background-image: url(https://raw.githubusercontent.com/8128/PicGo/master/20200326135918.png)"><div id="page-header"><span class="pull_left" id="blog_name"><a class="blog_title" id="site-name" href="/">8128's Blog</a></span><span class="pull_right menus"><div id="search_button"><a class="site-page social-icon search"><i class="fa fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> Link</span></a></div></div><span class="toggle-menu close"><a class="site-page"><i class="fa fa-bars fa-fw" aria-hidden="true"></i></a></span></span></div><div id="post-info"><div id="post-title"><div class="posttitle">JS测试教程</div></div><div id="post-meta"><div class="meta-firstline"><time class="post-meta__date"><span class="post-meta__date-created" title="发表于 2020-03-26 12:32:00"><i class="fa fa-calendar" aria-hidden="true"></i> 发表于 2020-03-26</span><span class="post-meta__separator">|</span><span class="post-meta__date-updated" title="更新于 2020-03-29 16:14:52"><i class="fa fa-history" aria-hidden="true"></i> 更新于 2020-03-29</span></time><span class="post-meta__categories"><span class="post-meta__separator">|</span><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/javascript/">javascript</a></span></div><div class="meta-secondline"> <span class="post-meta-wordcount"><i class="post-meta__icon fa fa-file-word-o" aria-hidden="true"></i><span>字数总计:</span><span class="word-count">6.7k</span><span class="post-meta__separator">|</span><i class="post-meta__icon fa fa-clock-o" aria-hidden="true"></i><span>阅读时长: 25 分钟</span></span></div><div class="meta-thirdline"><span class="post-meta-pv-cv"><span class="post-meta__separator">|</span><i class="fa fa-eye post-meta__icon" aria-hidden="true"> </i><span>阅读量:</span><span id="busuanzi_value_page_pv"></span></span><span class="post-meta-commentcount"></span></div></div></div></div><main class="layout_post" id="content-inner"><article id="post"><div id="article-container"><p>来源：<a href="https://javascript.ruanyifeng.com/tool/testing.html" target="_blank" rel="noopener">阮一峰</a></p>
<h2 id="为什么要写测试？"><a href="#为什么要写测试？" class="headerlink" title="为什么要写测试？"></a>为什么要写测试？</h2><p>Web应用程序越来越复杂，这意味着有更多的可能出错。测试是帮助我们提高代码质量、降低错误的最好方法和工具之一。</p>
<ul>
<li>测试可以确保得到预期结果。</li>
<li>加快开发速度。</li>
<li>方便维护。</li>
<li>提供用法的文档。</li>
</ul>
<p>通过测试提供软件的质量，在开始的时候，可能会降低开发速度。但是从长期看，尤其是那种代码需要长期维护、不断开发的情况，测试会大大加快开发速度，减轻维护难度。</p>
<h2 id="测试的类型"><a href="#测试的类型" class="headerlink" title="测试的类型"></a>测试的类型</h2><h3 id="单元测试"><a href="#单元测试" class="headerlink" title="单元测试"></a>单元测试</h3><p>单元测试（unit testing）指的是以软件的单元（unit）为单位，对软件进行测试。单元可以是一个函数，也可以是一个模块或组件。它的基本特征就是，只要输入不变，必定返回同样的输出。</p>
<p>“单元测试”这个词，本身就暗示，软件应该以模块化结构存在。每个模块的运作，是独立于其他模块的。一个软件越容易写单元测试，往往暗示着它的模块化结构越好，各模块之间的耦合就越弱；越难写单元测试，或者每次单元测试，不得不模拟大量的外部条件，很可能暗示软件的模块化结构越差，模块之间存在较强的耦合。</p>
<p>单元测试的要求是，每个模块都必须有单元测试，而软件由模块组成。</p>
<p>单元测试通常采取断言（assertion）的形式，也就是测试某个功能的返回结果，是否与预期结果一致。如果与预期不一致，就表示测试失败。</p>
<p>单元测试是函数正常工作、不出错的最基本、最有效的方法之一。 每一个单元测试发出一个特定的输入到所要测试的函数，看看函数是否返回预期的输出，或者采取了预期的行动。单元测试证明了所测试的代码行为符合预期。</p>
<p>单元测试有助于代码的模块化，因此有助于长期的重用。因为有了测试，你就知道代码是可靠的，可以按照预期运行。从这个角度说，测试可以节省开发时间。单元测试的另一个好处是，有了测试，就等于就有了代码功能的文档，有助于其他开发者了解代码的意图。</p>
<p>单元测试应该避免依赖性问题，比如不存取数据库、不访问网络等等，而是使用工具虚拟出运行环境。这种虚拟使得测试成本最小化，不用花大力气搭建各种测试环境。</p>
<p>一般来说，单元测试的步骤如下。</p>
<ul>
<li>准备所有的测试条件</li>
<li>调用（触发）所要测试的函数</li>
<li>验证运行结果是否正确</li>
<li>还原被修改的记录</li>
</ul>
<h3 id="其他测试类型"><a href="#其他测试类型" class="headerlink" title="其他测试类型"></a>其他测试类型</h3><p>（1）集成测试</p>
<p>集成测试（Integration test）指的是多个部分在一起测试，比如测试一个数据库连接模块，是否能够连接数据库。</p>
<p>（2）功能测试</p>
<p>功能测试（Functional test）指的是，自动测试整个应用程序的某个功能，比如使用Selenium工具自动打开浏览器运行程序。</p>
<p>（3）端对端测试</p>
<p>端对端测试（End-to-End testing）指的是全链路测试，即从开始端到终止端的测试，比如测试从用户界面、通过网络、经过应用程序处理、到达数据库，是否能够返回正确结果。端对端测试的目的是，确保整个系统能够正常运行，各个子系统之间依赖关系正常，数据能够在子系统之间、模块之间正确传递。</p>
<p>（4）冒烟测试</p>
<p>冒烟测试（smoke testing）指的是，正式的全面测试开始之前，对主要功能进行的预测试。它的主要目的是，确认主要功能能否满足需要，软件是否能运行。冒烟测试可以是手工测试，也可以是自动化测试。</p>
<p>这个名字最早来自对电子元件的测试，第一次对电子元件通电，看看它是否会冒烟。如果没有冒烟，说明通过了测试；如果电流达到某个临界点之后，才出现冒烟，这时可以评估是否能够接受这个临界点。</p>
<h2 id="开发模式"><a href="#开发模式" class="headerlink" title="开发模式"></a>开发模式</h2><p>测试不仅能够验证软件功能、保证代码质量，也能够影响软件开发的模式。</p>
<h3 id="TDD"><a href="#TDD" class="headerlink" title="TDD"></a>TDD</h3><p>TDD是“测试驱动的开发”（Test-Driven Development）的简称，指的是先写好测试，然后再根据测试完成开发。使用这种开发方式，会有很高的测试覆盖率。</p>
<p>TDD的开发步骤如下。</p>
<ul>
<li>先写一个测试。</li>
<li>写出最小数量的代码，使其能够通过测试。</li>
<li>优化代码。</li>
<li>重复前面三步。</li>
</ul>
<p>TDD开发的测试覆盖率通常在90%以上，这意味着维护代码和新增特性会非常容易。因为测试保证了你可以信任这些代码，修改它们不会破坏其他代码的运行。</p>
<p>TDD接口提供以下四个方法。</p>
<ul>
<li>suite()</li>
<li>test()</li>
<li>setup()</li>
<li>teardown()</li>
</ul>
<p>下面代码是测试计数器是否加1。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">suite(<span class="string">'Counter'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  test(<span class="string">'tick increases count to 1'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> counter = <span class="keyword">new</span> Counter();</span><br><span class="line">    counter.tick();</span><br><span class="line">    assert.equal(counter.count, <span class="number">1</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="BDD"><a href="#BDD" class="headerlink" title="BDD"></a>BDD</h3><p>BDD是“行为驱动的开发”（Behavior-Driven Development）的简称，指的是写出优秀测试的最佳实践的总称。</p>
<p>BDD认为，<strong>不应该针对代码的实现细节写测试，而是要针对行为写测试</strong>。BDD测试的是行为，即软件应该怎样运行。</p>
<p>BDD接口提供以下六个方法。</p>
<ul>
<li>describe()</li>
<li>it()</li>
<li>before()</li>
<li>after()</li>
<li>beforeEach()</li>
<li>afterEach()</li>
</ul>
<p>下面是测试计数器是否加1的BDD写法。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">describe(<span class="string">'Counter'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  it(<span class="string">'should increase count by 1 after calling tick'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> counter = <span class="keyword">new</span> Counter();</span><br><span class="line">    <span class="keyword">var</span> expectedCount = counter.count + <span class="number">1</span>;</span><br><span class="line">    counter.tick();</span><br><span class="line">    assert.equal(counter.count, expectedCount);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>下面是一个BDD开发的示例。现在，需要开发一个<code>Foo</code>类，该类的实例有一个<code>sayHi</code>方法，会对类参数说“Hi”。这就是<code>Foo</code>类的规格，根据这个规格，我们可以写出测试用例文件<code>foo.spec.js</code>。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">describe(<span class="string">'Simple object'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> foo;</span><br><span class="line"></span><br><span class="line">  beforeEach(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    foo = <span class="keyword">new</span> Foo(<span class="string">'John'</span>);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  it(<span class="string">'should say hi'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    expect(foo.sayHi()).toEqual(<span class="string">'John says hi!'</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>有了测试用例以后，我们再写出实际的脚本文件<code>foo.js</code>。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Foo</span>(<span class="params">name</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.name = name;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Foo.prototype.sayHi = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">this</span>.name + <span class="string">' says hi!'</span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>为了把测试用例与脚本文件分开，我们通常把测试用例放在<code>test</code>子目录之中。然后，我们就可以使用Mocha、Jasmine等测试框架，执行测试用例，看看脚本文件是否通过测试。</p>
<h3 id="BDD术语"><a href="#BDD术语" class="headerlink" title="BDD术语"></a>BDD术语</h3><p>（1）测试套件</p>
<p>测试套件（test suite）指的是，一组针对软件规格的某个方面的测试用例。也可以看作，对软件的某个方面的描述（describe）。</p>
<p>测试套件由一个<code>describe</code>函数构成，它接受两个参数：第一个参数是字符串，表示测试套件的名字或标题，表示将要测试什么；第二个参数是函数，用来实现这个测试套件。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">describe(<span class="string">"A suite"</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>（2）测试用例</p>
<p>测试用例（test case）指的是，针对软件一个功能点的测试，是软件测试的最基本单位。一组相关的测试用例，构成一个测试套件。测试用例由<code>it</code>函数构成，它与<code>describe</code>函数一样，接受两个参数：第一个参数是字符串，表示测试用例的标题；第二个参数是函数，用来实现这个测试用例。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">describe(<span class="string">"A suite"</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  it(<span class="string">"contains spec with an expectation"</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>（3）断言</p>
<p>断言（assert）指的是对代码行为的预期。一个测试用例内部，包含一个或多个断言（assert）。</p>
<p>断言会返回一个布尔值，表示代码行为是否符合预期。测试用例之中，只要有一个断言为false，这个测试用例就会失败，只有所有断言都为<code>true</code>，测试用例才会通过。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">describe(<span class="string">"A suite"</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  it(<span class="string">"contains spec with an expectation"</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    expect(<span class="literal">true</span>).toBe(<span class="literal">true</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="断言"><a href="#断言" class="headerlink" title="断言"></a>断言</h2><p>断言是判断实际值与预期值是否相等的工具。</p>
<p>断言有assert、expect、should三种风格，或者称为三种写法。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// assert风格</span></span><br><span class="line">assert.equal(event.detail.item, <span class="string">'(item)‘);</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">// expect风格</span></span><br><span class="line"><span class="string">expect(event.detail.item).to.equal('</span>(item)<span class="string">');</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">// should风格</span></span><br><span class="line"><span class="string">event.detail.item.should.equal('</span>(item)<span class="string">');</span></span><br></pre></td></tr></table></figure>

<p>Chai.js是一个很流行的断言库，同时支持上面三种风格。</p>
<p>（1） assert风格</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> assert = <span class="built_in">require</span>(<span class="string">'chai'</span>).assert;</span><br><span class="line"><span class="keyword">var</span> foo = <span class="string">'bar'</span>;</span><br><span class="line"><span class="keyword">var</span> beverages = &#123; <span class="attr">tea</span>: [ <span class="string">'chai'</span>, <span class="string">'matcha'</span>, <span class="string">'oolong'</span> ] &#125;;</span><br><span class="line"></span><br><span class="line">assert.typeOf(foo, <span class="string">'string'</span>, <span class="string">'foo is a string'</span>);</span><br><span class="line">assert.equal(foo, <span class="string">'bar'</span>, <span class="string">'foo equal `bar`'</span>);</span><br><span class="line">assert.lengthOf(foo, <span class="number">3</span>, <span class="string">'foo`s value has a length of 3'</span>);</span><br><span class="line">assert.lengthOf(beverages.tea, <span class="number">3</span>, <span class="string">'beverages has 3 types of tea'</span>);</span><br></pre></td></tr></table></figure>

<p>上面代码中，assert方法的最后一个参数是错误提示信息，只有测试没有通过时，才会显示。</p>
<p>（2）expect风格</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> expect = <span class="built_in">require</span>(<span class="string">'chai'</span>).expect;</span><br><span class="line"><span class="keyword">var</span> foo = <span class="string">'bar'</span>;</span><br><span class="line"><span class="keyword">var</span> beverages = &#123; <span class="attr">tea</span>: [ <span class="string">'chai'</span>, <span class="string">'matcha'</span>, <span class="string">'oolong'</span> ] &#125;;</span><br><span class="line"></span><br><span class="line">expect(foo).to.be.a(<span class="string">'string'</span>);</span><br><span class="line">expect(foo).to.equal(<span class="string">'bar'</span>);</span><br><span class="line">expect(foo).to.have.length(<span class="number">3</span>);</span><br><span class="line">expect(beverages).to.have.property(<span class="string">'tea'</span>).with.length(<span class="number">3</span>);</span><br></pre></td></tr></table></figure>

<p>（3）should风格</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> should = <span class="built_in">require</span>(<span class="string">'chai'</span>).should();</span><br><span class="line"><span class="keyword">var</span> foo = <span class="string">'bar'</span>;</span><br><span class="line"><span class="keyword">var</span> beverages = &#123; <span class="attr">tea</span>: [ <span class="string">'chai'</span>, <span class="string">'matcha'</span>, <span class="string">'oolong'</span> ] &#125;;</span><br><span class="line"></span><br><span class="line">foo.should.be.a(<span class="string">'string'</span>);</span><br><span class="line">foo.should.equal(<span class="string">'bar'</span>);</span><br><span class="line">foo.should.have.length(<span class="number">3</span>);</span><br><span class="line">beverages.should.have.property(<span class="string">'tea'</span>).with.length(<span class="number">3</span>);</span><br></pre></td></tr></table></figure>

<h2 id="Mocha-js"><a href="#Mocha-js" class="headerlink" title="Mocha.js"></a>Mocha.js</h2><h3 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h3><p>Mocha（发音“摩卡”）是现在最流行的前端测试框架之一，此外常用的测试框架还有<a href="https://jasmine.github.io/" target="_blank" rel="noopener">Jasmine</a>、<a href="https://github.com/substack/tape/" target="_blank" rel="noopener">Tape</a>、<a href="https://github.com/defunctzombie/zuul/" target="_blank" rel="noopener">zuul</a>等。所谓“测试框架”，就是运行测试的工具。</p>
<p>Mocha使用下面的命令安装。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># 全局安装</span><br><span class="line">$ npm install -g mocha chai</span><br><span class="line"></span><br><span class="line"># 项目内安装</span><br><span class="line">$ npm i -D mocha chai</span><br></pre></td></tr></table></figure>

<p>上面代码中，除了安装Mocha以外，还安装了断言库<code>chai</code>，这是因为Mocha自身不带断言库，必须安装外部断言库。</p>
<p>测试套件文件一般放在<code>test</code>子目录下面，配置文件<code>mocha.opts</code>也放在这个目录里面。</p>
<h3 id="浏览器测试"><a href="#浏览器测试" class="headerlink" title="浏览器测试"></a>浏览器测试</h3><p>使用浏览器测试时，先用<code>mocha init</code>命令在指定目录生成初始化文件。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ mocha init &lt;path&gt;</span><br></pre></td></tr></table></figure>

<p>运行上面命令，就会在该目录下生成一个<code>index.html</code>文件，以及配套的脚本和样式表。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">  &lt;head&gt;</span><br><span class="line">    &lt;title&gt;Unit.js tests <span class="keyword">in</span> the browser <span class="keyword">with</span> Mocha&lt;<span class="regexp">/title&gt;</span></span><br><span class="line"><span class="regexp">    &lt;meta http-equiv="Content-Type" content="text/</span>html; charset=UTF<span class="number">-8</span><span class="string">"&gt;</span></span><br><span class="line"><span class="string">    &lt;meta name="</span>viewport<span class="string">" content="</span>width=device-width, initial-scale=<span class="number">1.0</span><span class="string">"&gt;</span></span><br><span class="line"><span class="string">    &lt;link rel="</span>stylesheet<span class="string">" href="</span>mocha.css<span class="string">" /&gt;</span></span><br><span class="line"><span class="string">  &lt;/head&gt;</span></span><br><span class="line"><span class="string">  &lt;body&gt;</span></span><br><span class="line"><span class="string">    &lt;h1&gt;Unit.js tests in the browser with Mocha&lt;/h1&gt;</span></span><br><span class="line"><span class="string">    &lt;div id="</span>mocha<span class="string">"&gt;&lt;/div&gt;</span></span><br><span class="line"><span class="string">    &lt;script src="</span>mocha.js<span class="string">"&gt;&lt;/script&gt;</span></span><br><span class="line"><span class="string">    &lt;script&gt;</span></span><br><span class="line"><span class="string">      mocha.setup('bdd');</span></span><br><span class="line"><span class="string">    &lt;/script&gt;</span></span><br><span class="line"><span class="string">    &lt;script src="</span>tests.js<span class="string">"&gt;&lt;/script&gt;</span></span><br><span class="line"><span class="string">    &lt;script&gt;</span></span><br><span class="line"><span class="string">      mocha.run();</span></span><br><span class="line"><span class="string">    &lt;/script&gt;</span></span><br><span class="line"><span class="string">  &lt;/body&gt;</span></span><br><span class="line"><span class="string">&lt;/html&gt;</span></span><br></pre></td></tr></table></figure>

<p>然后在该文件中，加入你要测试的文件（比如<code>app.js</code>）、测试脚本（<code>app.spec.js</code>）和断言库（<code>chai.js</code>）。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;script src=<span class="string">"app.js"</span>&gt;&lt;<span class="regexp">/script&gt;</span></span><br><span class="line"><span class="regexp">&lt;script src="http:/</span><span class="regexp">/chaijs.com/</span>chai.js<span class="string">"&gt;&lt;/script&gt;</span></span><br><span class="line"><span class="string">&lt;script src="</span>app.spec.js<span class="string">"&gt;&lt;/script&gt;</span></span><br></pre></td></tr></table></figure>

<p>各个文件的内容如下。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// app.js</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">add</span>(<span class="params">x, y</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">return</span> x + y;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// app.spec.js</span></span><br><span class="line"><span class="keyword">var</span> expect = chai.expect;</span><br><span class="line"></span><br><span class="line">describe(<span class="string">'测试add函数'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  it(<span class="string">'1加1应该等于2'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    expect(add(<span class="number">1</span>, <span class="number">1</span>)).to.equal(<span class="number">2</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="命令行测试"><a href="#命令行测试" class="headerlink" title="命令行测试"></a>命令行测试</h3><p>Mocha除了在浏览器运行，还可以在命令行运行。</p>
<p>还是使用上面的文件，作为例子，但是要改成CommonJS格式。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// app.js</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">add</span>(<span class="params">x, y</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">return</span> x + y;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = add;</span><br><span class="line"></span><br><span class="line"><span class="comment">// app.spec.js</span></span><br><span class="line"><span class="keyword">var</span> expect = <span class="built_in">require</span>(<span class="string">'chai'</span>).expect;</span><br><span class="line"><span class="keyword">var</span> add = <span class="built_in">require</span>(<span class="string">'../app'</span>);</span><br><span class="line"></span><br><span class="line">describe(<span class="string">'测试add函数'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  it(<span class="string">'1加1应该等于2'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    expect(add(<span class="number">1</span>, <span class="number">1</span>)).to.equal(<span class="number">2</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>然后，在命令行下执行<code>mocha</code>，就会执行测试。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ mocha</span><br></pre></td></tr></table></figure>

<p>上面的命令等同于下面的形式。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ mocha <span class="built_in">test</span> --reporter spec --recursive --growl</span><br></pre></td></tr></table></figure>

<h3 id="mocha-opts"><a href="#mocha-opts" class="headerlink" title="mocha.opts"></a>mocha.opts</h3><p>所有Mocha的命令行参数，都可以写在<code>test</code>目录下的配置文件<code>mocha.opts</code>之中。</p>
<p>下面是一个典型的配置文件。</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">--reporter</span> <span class="string">spec</span></span><br><span class="line"><span class="attr">--recursive</span></span><br><span class="line"><span class="attr">--growl</span></span><br></pre></td></tr></table></figure>

<p>上面三个设置的含义如下。</p>
<ul>
<li>使用spec报告模板</li>
<li>包括子目录</li>
<li>打开桌面通知插件growl</li>
</ul>
<p>如果希望测试非存放于test子目录的测试用例，可以在<code>mocha.opts</code>写入以下内容。</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server-tests</span></span><br><span class="line"><span class="attr">--recursive</span></span><br></pre></td></tr></table></figure>

<p>上面代码指定运行<code>server-tests</code>目录及其子目录之中的测试脚本。</p>
<h3 id="生成规格文件"><a href="#生成规格文件" class="headerlink" title="生成规格文件"></a>生成规格文件</h3><p>Mocha支持从测试用例生成规格文件。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ mocha <span class="built_in">test</span>/app.spec.js -R markdown &gt; spec.md</span><br></pre></td></tr></table></figure>

<p>上面命令生成单个<code>app.spec.js</code>规格。</p>
<p>生成HTML格式的报告，使用下面的命令。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ mocha <span class="built_in">test</span>/app.spec.js -R doc &gt; spec.html</span><br></pre></td></tr></table></figure>

<p>如果要生成整个<code>test</code>目录，对应的规格文件，使用下面的命令。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ mocha <span class="built_in">test</span> -R markdown &gt; spec.md --recursive</span><br></pre></td></tr></table></figure>

<p>只要提供测试脚本的路径，Mocha就可以运行这个测试脚本。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ mocha -w src/index.test.js</span><br></pre></td></tr></table></figure>

<p>上面命令运行测试脚本<code>src/index.test.js</code>，参数<code>-w</code>表示watch，即当这个脚本一有变动，就会运行。</p>
<p>指定测试脚本时，可以使用通配符，同时指定多个文件。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ mocha --reporter spec spec/&#123;my,awesome&#125;.js</span><br><span class="line">$ mocha --ui tdd <span class="built_in">test</span>/unit/*.js etc</span><br></pre></td></tr></table></figure>

<p>上面代码中，参数<code>--reporter</code>指定生成的报告格式（上面代码是spec格式），<code>-ui</code>指定采用哪一种测试模式（上面代码是tdd模式）。</p>
<p>除了使用shell通配符，还可以使用node通配符。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ mocha --compilers js:babel-core/register <span class="string">'test/**/*.@(js|jsx)'</span></span><br></pre></td></tr></table></figure>

<p>上面代码指定运行<code>test</code>目录下面任何子目录中，文件后缀名为<code>js</code>或<code>jsx</code>的测试脚本。注意，Node的通配符要放在单引号之中，因为否则星号（<code>*</code>）会先被shell解释。</p>
<p>如果要改用shell通配符，执行<code>test</code>目录下面任何子目录的测试脚本，要写成下面这样。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ mocha <span class="built_in">test</span>/**.js</span><br></pre></td></tr></table></figure>

<p>如果测试脚本不止一个，最好将它们放在专门的目录当中。Mocha默认执行<code>test</code>目录的测试脚本，所以可以将所有测试脚本放在<code>test</code>子目录。<code>--recursive</code>参数可以指定运行子目录之中的测试脚本。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ mocha --recursive</span><br></pre></td></tr></table></figure>

<p>上面命令会运行<code>test</code>子目录之中的所有测试脚本。</p>
<p><code>--grep</code>参数用于搜索测试用例的名称（即it方法的第一个参数），然后只执行匹配的测试用例。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ mocha --reporter spec --grep <span class="string">"Fnord:"</span> server-test/*.js</span><br></pre></td></tr></table></figure>

<p>上面代码只测试名称中包含“Fnord：”的测试用例。</p>
<p><code>--invert</code>参数表示只运行不符合条件的测试脚本。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ mocha --grep auth --invert</span><br></pre></td></tr></table></figure>

<p>如果测试脚本用到了ES6语法，还需要用<code>--compiler</code>参数指定babel进行转码。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ mocha --compilers js:babel/register --recursive</span><br></pre></td></tr></table></figure>

<p>上面命令会在运行测试脚本之前，先用Babel进行转码。<code>--compilers</code>参数的值是用冒号分隔的一个字符串，冒号左边是文件的后缀名，右边是用来处理这一类文件的模块名。上面代码表示，运行测试之前，先用<code>babel/register</code>模块，处理一下JS文件。</p>
<p><code>--require</code>参数指定测试脚本默认包含的文件。下面是一个<code>test_helper.js</code>文件。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// test/test_helper.js</span></span><br><span class="line"><span class="keyword">import</span> chai <span class="keyword">from</span> <span class="string">'chai'</span>;</span><br></pre></td></tr></table></figure>

<p>使用<code>--require</code>参数，将上面这个脚本包含进所有测试脚本。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ mocha --compilers js:babel/register --require ./<span class="built_in">test</span>/test_helper.js  --recursive</span><br></pre></td></tr></table></figure>

<h3 id="测试脚本的写法"><a href="#测试脚本的写法" class="headerlink" title="测试脚本的写法"></a>测试脚本的写法</h3><p>测试脚本中，describe方法和it方法都允许调用only方法，表示只运行某个测试套件或测试用例。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 例一</span></span><br><span class="line">describe(<span class="string">'Array'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  describe.only(<span class="string">'#indexOf()'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    ...</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 例二</span></span><br><span class="line">describe(<span class="string">"using only"</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  it.only(<span class="string">"this is the only test to be run"</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  it(<span class="string">"this is not run"</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>上面代码中，只有带有<code>only</code>方法的测试套件或测试用例会运行。</p>
<p>describe方法和it方法还可以调用skip方法，表示跳过指定的测试套件或测试用例。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 例一</span></span><br><span class="line">describe.skip(<span class="string">'Article'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 例二</span></span><br><span class="line">describe(<span class="string">"using only"</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  it.skip(<span class="string">"this is the only test to be run"</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  it(<span class="string">"this is not run"</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>上面代码中，带有<code>skip</code>方法的测试套件或测试用例会被忽略。</p>
<p>如果测试用例包含异步操作，可以done方法显式指定测试用例的运行结束时间。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">it(<span class="string">'logs a'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">done</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> f = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'logs a'</span>);</span><br><span class="line">    done();</span><br><span class="line">  &#125;;</span><br><span class="line">  setTimeout(f, <span class="number">500</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>上面代码中，正常情况下，函数f还没有执行，Mocha就已经结束运行了。为了保证Mocha等到测试用例跑完再结束运行，可以手动调用done方法</p>
<h2 id="Promise的测试"><a href="#Promise的测试" class="headerlink" title="Promise的测试"></a>Promise的测试</h2><p>对于异步的测试，测试用例之中，通常必须调用<code>done</code>方法，显式表明异步操作的结束。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> expect = <span class="built_in">require</span>(<span class="string">'chai'</span>).expect;</span><br><span class="line"></span><br><span class="line">it(<span class="string">'should do something with promises'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">done</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> result = asyncTest();</span><br><span class="line"></span><br><span class="line">  result.then(<span class="function"><span class="keyword">function</span>(<span class="params">data</span>) </span>&#123;</span><br><span class="line">    expect(data).to.equal(<span class="string">'foobar'</span>);</span><br><span class="line">    done();</span><br><span class="line">  &#125;, <span class="function"><span class="keyword">function</span>(<span class="params">error</span>) </span>&#123;</span><br><span class="line">    assert.fail(error);</span><br><span class="line">    done();</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>上面代码之中，Promise对象的<code>then</code>方法之中，必须指定<code>reject</code>时的回调函数，并且使用<code>assert.fail</code>方法抛出错误，否则这个错误就不会被外界感知。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">result.then(<span class="function"><span class="keyword">function</span>(<span class="params">data</span>) </span>&#123;</span><br><span class="line">  expect(data).to.equal(blah);</span><br><span class="line">  done();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>上面代码之中，如果Promise被<code>reject</code>，是不会被捕获的，因为Promise之中的错误，不会”泄漏“到外界。</p>
<p>Mocha内置了对Promise的支持。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">it(<span class="string">'should fail the test'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> p = <span class="built_in">Promise</span>.reject(<span class="string">'Promise被reject'</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> p;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>上面代码中，Mocha能够捕获<code>reject</code>的Promise。</p>
<p>因此，使用Mocha时，Promise的测试可以简化成下面的写法。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> expect = <span class="built_in">require</span>(<span class="string">'chai'</span>).expect;</span><br><span class="line"></span><br><span class="line">it(<span class="string">'should do something with promises'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> result = asyncTest();</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> result.then(<span class="function"><span class="keyword">function</span>(<span class="params">data</span>) </span>&#123;</span><br><span class="line">    expect(data).to.equal(<span class="string">'foobar'</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="模拟数据"><a href="#模拟数据" class="headerlink" title="模拟数据"></a>模拟数据</h2><p>单元测试时，很多时候，测试的代码会请求HTTP服务器。这时，我们就需要模拟服务器的回应，不能在单元测试时去请求真实服务器数据，否则就不叫单元测试了，而是连同服务器一起测试了。</p>
<p>一些工具库可以模拟服务器回应。</p>
<ul>
<li><a href="https://github.com/pgte/nock" target="_blank" rel="noopener">nock</a></li>
<li><a href="http://sinonjs.org/docs/#server" target="_blank" rel="noopener">sinon</a></li>
<li><a href="https://github.com/algolia/faux-jax" target="_blank" rel="noopener">faux-jax</a></li>
<li><a href="https://github.com/moll/node-mitm" target="_blank" rel="noopener">MITM</a></li>
</ul>
<h2 id="覆盖率"><a href="#覆盖率" class="headerlink" title="覆盖率"></a>覆盖率</h2><p>测试的覆盖率需要安装istanbul模块。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm i -D istanbul</span><br></pre></td></tr></table></figure>

<p>然后，在package.json设置运行覆盖率检查的命令。</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">"scripts": &#123;</span><br><span class="line">  "test:cover": "istanbul cover -x *.test.js _mocha -- -R spec src/index.test.js",</span><br><span class="line">  "check-coverage": "istanbul check-coverage --statements 100 --branches 100 --functions 100 --lines 100"</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>上面代码中，<code>test:cover</code>是生成覆盖率报告，<code>check-coverage</code>是设置覆盖率通过的门槛。</p>
<p>然后，将<code>coverage</code>目录写入<code>.gitignore</code>防止连这个目录一起提交。</p>
<p>如果希望在<code>git commit</code>提交之前，先运行一次测试，可以安装ghooks模块，配置<code>pre-commit</code>钩子。</p>
<p>安装ghooks。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm i -D ghooks</span><br></pre></td></tr></table></figure>

<p>在package.json之中，配置<code>pre-commit</code>钩子。</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">"config": &#123;</span><br><span class="line">  "ghooks": &#123;</span><br><span class="line">    "pre-commit": "npm run test:cover &amp;&amp; npm run check-coverage"</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>还可以把覆盖率检查，加入<code>.travis.yml</code>文件。</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">script:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">npm</span> <span class="string">run</span> <span class="string">test:cover</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">npm</span> <span class="string">run</span> <span class="string">check-coverage</span></span><br></pre></td></tr></table></figure>

<p>如果测试脚本使用ES6，<code>scripts</code>字段还需要加入Babel转码。</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">"scripts": &#123;</span><br><span class="line">  "test": "mocha src/index.test.js -w --compilers js:babel/register",</span><br><span class="line">  "test:cover": "istanbul cover -x *.test.js _mocha -- -R spec src/index.test.js --compilers js:babel/register"</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>覆盖率报告可以上传到<a href="https://codecov.io/" target="_blank" rel="noopener">codecov.io</a>。先安装这个模块。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm i -D codecov.io</span><br></pre></td></tr></table></figure>

<p>然后在package.json增加一个字段。</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">"scripts": &#123;</span><br><span class="line">  "report-coverage": "cat ./coverage/lcov.info | codecov"</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>最后，在CI的配置文件<code>.travis.yml</code>之中，增加运行这个命令。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">after_success:</span><br><span class="line">  - npm run report-coverage</span><br><span class="line">  - npm run semantic-release</span><br></pre></td></tr></table></figure>

<h2 id="WebDriver"><a href="#WebDriver" class="headerlink" title="WebDriver"></a>WebDriver</h2><p>WebDriver是一个浏览器的自动化框架。它在各种浏览器的基础上，提供一个统一接口，将接收到的指令转为浏览器的原生指令，驱动浏览器。</p>
<p>WebDriver由Selenium项目演变而来。Selenium是一个测试自动化框架，它的1.0版叫做Selenium RC，通过一个代理服务器，将测试脚本转为JavaScript脚本，注入不同的浏览器，再由浏览器执行这些脚本后返回结果。WebDriver就是Selenium 2.0，它对每个浏览器提供一个驱动，测试脚本通过驱动转换为浏览器原生命令，在浏览器中执行。</p>
<h3 id="定制测试环境"><a href="#定制测试环境" class="headerlink" title="定制测试环境"></a>定制测试环境</h3><p>DesiredCapabilities对象用于定制测试环境。</p>
<ul>
<li>定制DesiredCapabilities对象的各个属性</li>
<li>创建DesiredCapabilities实例</li>
<li>将DesiredCapabilities实例作为参数，新建一个WebDriver实例</li>
</ul>
<h3 id="操作浏览器的方法"><a href="#操作浏览器的方法" class="headerlink" title="操作浏览器的方法"></a>操作浏览器的方法</h3><p>WebDriver提供以下方法操作浏览器。</p>
<p>close()：退出或关闭当前浏览器窗口。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">driver.close();</span><br></pre></td></tr></table></figure>

<p>quit()：关闭所有浏览器窗口，中止当前浏览器driver和session。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">driver.quit();</span><br></pre></td></tr></table></figure>

<p>getTitle()：返回当前网页的标题。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">driver.getTitle();</span><br></pre></td></tr></table></figure>

<p>getCurrentUrl()：返回当前网页的网址。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">driver.getCurrentUrl();</span><br></pre></td></tr></table></figure>

<p>getPageSource()：返回当前网页的源码。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 断言是否含有指定文本</span></span><br><span class="line">assert(driver.getPageSource().contains(<span class="string">"Hello World"</span>),</span><br><span class="line">  <span class="string">"预期含有文本Hello World"</span>);</span><br></pre></td></tr></table></figure>

<p>click()：模拟鼠标点击。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 例一</span></span><br><span class="line">driver.findElement(By.locatorType(<span class="string">"path"</span>))</span><br><span class="line">  .click();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 例二</span></span><br><span class="line">driver.get(<span class="string">"https://www.google.com"</span>);</span><br><span class="line">driver.findElement(By.name(<span class="string">"q"</span>))</span><br><span class="line">  .sendKeys(<span class="string">"webDriver"</span>);</span><br><span class="line">driver.findElement(By.id(<span class="string">"sblsbb"</span>))</span><br><span class="line">  .click();</span><br></pre></td></tr></table></figure>

<p>clear()：清空文本输入框。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 例一</span></span><br><span class="line">driver.findElement(By.locatorType(<span class="string">"path"</span>)).clear();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 例二</span></span><br><span class="line">driver.get(<span class="string">"https://www.google.com"</span>);</span><br><span class="line">driver.findElement(By.name(<span class="string">"q"</span>))</span><br><span class="line">  .sendKeys(<span class="string">"webDriver"</span>);</span><br><span class="line">driver.findElement(By.name(<span class="string">"q"</span>))</span><br><span class="line">  .clear();</span><br><span class="line">driver.findElement(By.name(<span class="string">"q"</span>))</span><br><span class="line">  .sendKeys(<span class="string">"testing"</span>);</span><br></pre></td></tr></table></figure>

<p>sendKeys()：在文本输入框输入文本。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">driver.findElement(By.locatorType(<span class="string">"path"</span>))</span><br><span class="line">  .sendKeys(<span class="string">"your text"</span>);</span><br></pre></td></tr></table></figure>

<p>submit()：提交表单，或者用来模拟按下回车键。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 例一</span></span><br><span class="line">driver.findElement(By.locatorType(<span class="string">"path"</span>))</span><br><span class="line">  .submit();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 例二</span></span><br><span class="line">driver.get(<span class="string">"https://www.google.com"</span>);</span><br><span class="line">driver.findElement(By.name(<span class="string">"q"</span>))</span><br><span class="line">  .sendKeys(<span class="string">"webdriver"</span>);</span><br><span class="line">element.submit();</span><br></pre></td></tr></table></figure>

<p>findElement()：返回选中的第一个元素。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">driver.get(<span class="string">"https://www.google.com"</span>);</span><br><span class="line">driver.findElement(By.id(<span class="string">"lst-ib"</span>));</span><br></pre></td></tr></table></figure>

<p>findElements()：返回选中的所有元素（0个或多个）。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 例一</span></span><br><span class="line">driver.findElement(By.id(<span class="string">"searchbox"</span>))</span><br><span class="line">  .sendKeys(<span class="string">"webdriver"</span>);</span><br><span class="line">driver.findElements(By.xpath(<span class="string">"//div[3]/ul/li"</span>))</span><br><span class="line">  .get(<span class="number">0</span>)</span><br><span class="line">  .click();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 例二</span></span><br><span class="line">driver.findElements(By.tagName(<span class="string">"select"</span>))</span><br><span class="line">  .get(<span class="number">0</span>)</span><br><span class="line">  .findElements(By.tagName(<span class="string">"option"</span>))</span><br><span class="line">  .get(<span class="number">3</span>)</span><br><span class="line">  .click()</span><br><span class="line">  .get(<span class="number">4</span>)</span><br><span class="line">  .click()</span><br><span class="line">  .get(<span class="number">5</span>)</span><br><span class="line">  .click();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 例三：获取页面所有链接</span></span><br><span class="line"><span class="keyword">var</span> links = driver</span><br><span class="line">  .get(<span class="string">"https://www.google.com"</span>)</span><br><span class="line">  .findElements(By.tagName(<span class="string">"a"</span>));</span><br><span class="line"><span class="keyword">var</span> linkSize = links.size();</span><br><span class="line"><span class="keyword">var</span> linksSrc = [];</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(linkSize);</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>;i&lt;linkSize;i++) &#123;</span><br><span class="line">  linksSrc[i] = links.get(i).getAttribute(<span class="string">"href"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(int i=<span class="number">0</span>;i&lt;linkSize;i++)&#123;</span><br><span class="line">  driver.navigate().to(linksSrc[i]);</span><br><span class="line">  Thread.sleep(<span class="number">3000</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>可以使用<code>size()</code>，查看到底选中了多少个元素。</p>
<h3 id="网页元素的定位"><a href="#网页元素的定位" class="headerlink" title="网页元素的定位"></a>网页元素的定位</h3><p>WebDriver提供8种定位器，用于定位网页元素。</p>
<ul>
<li>By.id：HTML元素的id属性</li>
<li>By.name：HTML元素的name属性</li>
<li>By.xpath：使用XPath语法选中HTML元素</li>
<li>By.cssSelector：使用CSS选择器语法</li>
<li>By.className：HTML元素的class属性</li>
<li>By.linkText：链接文本（只用于选中链接）</li>
<li>By.tagName：HTML元素的标签名</li>
<li>By.partialLinkText：部分链接文本（只用于选中链接）</li>
</ul>
<p>下面是一个使用id定位器，选中网页元素的例子。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">driver.findElement(By.id(<span class="string">"sblsbb"</span>)).click();</span><br></pre></td></tr></table></figure>

<h3 id="网页元素的方法"><a href="#网页元素的方法" class="headerlink" title="网页元素的方法"></a>网页元素的方法</h3><p>以下方法属于网页元素的方法，而不是webDriver实例的方法。需要注意的是，有些方法是某些元素特有的，比如只有文本框才能输入文字。如果在网页元素上调用不支持的方法，WebDriver不会报错，也不会给出给出任何提示，只会静静地忽略。</p>
<p>getAttribute()：返回网页元素指定属性的值。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">driver.get(<span class="string">"https://www.google.com"</span>);</span><br><span class="line">driver.findElement(By.xpath(<span class="string">"//div[@id='lst-ib']"</span>))</span><br><span class="line">  .getAttribute(<span class="string">"class"</span>);</span><br></pre></td></tr></table></figure>

<p>getText()：返回网页元素的内部文本。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">driver.findElement(By.locatorType(<span class="string">"path"</span>)).getText();</span><br></pre></td></tr></table></figure>

<p>getTagName()：返回指定元素的标签名。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">driver.get(<span class="string">"https://www.google.com"</span>);</span><br><span class="line">driver.findElement(By.xpath(<span class="string">"//div[@class='sbib_b']"</span>))</span><br><span class="line">  .getTagName();</span><br></pre></td></tr></table></figure>

<p>isDisplayed()：返回一个布尔值，表示元素是否可见。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">driver.get(<span class="string">"https://www.google.com"</span>);</span><br><span class="line">assert(driver.findElement(By.name(<span class="string">"q"</span>))</span><br><span class="line">  .isDisplayed(),</span><br><span class="line">  <span class="string">'搜索框应该可选择'</span>);</span><br></pre></td></tr></table></figure>

<p>isEnabled()：返回一个布尔值，表示文本框是否可编辑。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">driver.get(<span class="string">"https://www.google.com"</span>);</span><br><span class="line"><span class="keyword">var</span> Element = driver.findElement(By.name(<span class="string">"q"</span>));</span><br><span class="line"><span class="keyword">if</span> (Element.isEnabled()) &#123;</span><br><span class="line">  driver.findElement(By.name(<span class="string">"q"</span>))</span><br><span class="line">    .sendKeys(<span class="string">"Selenium Essentials"</span>);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">  <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>isSelected()：返回一个布尔值，表示一个元素是否可选择。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">driver.findElement(By.xpath(<span class="string">"//select[@name='jump']/option[1]"</span>))</span><br><span class="line">  .isSelected()</span><br></pre></td></tr></table></figure>

<p>getSize()：返回一个网页元素的宽度和高度。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> dimensions=driver.findElement(By.locatorType(<span class="string">"path"</span>))</span><br><span class="line">  .getSize(); </span><br><span class="line">dimensions.width;</span><br><span class="line">dimensions.height;</span><br></pre></td></tr></table></figure>

<p>getLocation()：返回网页元素左上角的x坐标和y坐标。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> point = driver.findElement(By.locatorType(<span class="string">"path"</span>)).getLocation();</span><br><span class="line">point.x; <span class="comment">// 等同于 point.getX();</span></span><br><span class="line">point.y; <span class="comment">// 等同于 point.getY();</span></span><br></pre></td></tr></table></figure>

<p>getCssValue()：返回网页元素指定的CSS属性的值。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">driver.get(<span class="string">"https://www.google.com"</span>);</span><br><span class="line"><span class="keyword">var</span> element = driver.findElement(By.xpath(<span class="string">"//div[@id='hplogo']"</span>));</span><br><span class="line"><span class="built_in">console</span>.log(element.getCssValue(<span class="string">"font-size"</span>));</span><br><span class="line"><span class="built_in">console</span>.log(element.getCssValue(<span class="string">"font-weight"</span>));</span><br><span class="line"><span class="built_in">console</span>.log(element.getCssValue(<span class="string">"color"</span>));</span><br><span class="line"><span class="built_in">console</span>.log(element.getCssValue(<span class="string">"background-size"</span>));</span><br></pre></td></tr></table></figure>

<h3 id="页面跳转的方法"><a href="#页面跳转的方法" class="headerlink" title="页面跳转的方法"></a>页面跳转的方法</h3><p>以下方法用来跳转到某一个页面。</p>
<p>get()：要求浏览器跳到某个网址。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">driver.get(<span class="string">"URL"</span>);</span><br></pre></td></tr></table></figure>

<p>navigate().back()：浏览器回退。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">driver.navigate().back();</span><br></pre></td></tr></table></figure>

<p>navigate().forward()：浏览器前进。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">driver.navigate().forward();</span><br></pre></td></tr></table></figure>

<p>navigate().to()：跳转到浏览器历史中的某个页面。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">driver.navigate().to(<span class="string">"URL"</span>);</span><br></pre></td></tr></table></figure>

<p>navigate().refresh()：刷新当前页面。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">driver.navigate().refresh();</span><br><span class="line"><span class="comment">// 等同于</span></span><br><span class="line">driver.navigate()</span><br><span class="line">  .to(driver.getCurrentUrl());</span><br><span class="line"><span class="comment">// 等同于</span></span><br><span class="line">driver.findElement(By.locatorType(<span class="string">"path"</span>))</span><br><span class="line">  .sendKeys(Keys.F5);</span><br></pre></td></tr></table></figure>



<h3 id="cookie的方法"><a href="#cookie的方法" class="headerlink" title="cookie的方法"></a>cookie的方法</h3><p>getCookies()：获取cookie</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">driver.get(<span class="string">"https://www.google.com"</span>);</span><br><span class="line">driver.manage().getCookies();</span><br></pre></td></tr></table></figure>

<p>getCookieNamed() ：返回指定名称的cookie。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">driver.get(<span class="string">"https://www.google.com"</span>);</span><br><span class="line"><span class="built_in">console</span>.log(driver.manage().getCookieNamed(<span class="string">"NID"</span>));</span><br></pre></td></tr></table></figure>

<p>addCookie()：将cookie加入当前页面。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">driver.get(<span class="string">"https://www.google.com"</span>);</span><br><span class="line">driver.manage().addCookie(cookie0);</span><br></pre></td></tr></table></figure>

<p>deleteCookie()：删除指定的cookie。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">driver.get(<span class="string">"https://www.google.co.in"</span>);</span><br><span class="line">driver.manage().deleteCookieNamed(<span class="string">"NID"</span>);</span><br></pre></td></tr></table></figure>



<h3 id="浏览器窗口的方法"><a href="#浏览器窗口的方法" class="headerlink" title="浏览器窗口的方法"></a>浏览器窗口的方法</h3><p>maximize()：最大化浏览器窗口。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> driver = <span class="keyword">new</span> FirefoxDriver();</span><br><span class="line">driver.manage().window().maximize();</span><br></pre></td></tr></table></figure>

<p>getSize()：返回浏览器窗口、图像、网页元素的宽和高。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">driver.manage().window().getSize();</span><br></pre></td></tr></table></figure>

<p>getPosition()：返回浏览器窗口左上角的x坐标和y坐标。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="string">"Position X: "</span> + driver.manage().window().getPosition().x);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">"Position Y: "</span> + driver.manage().window().getPosition().y);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">"Position X: "</span> + driver.manage().window().getPosition().getX());</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">"Position Y: "</span> + driver.manage().window().getPosition().getY());</span><br></pre></td></tr></table></figure>

<p>setSize()：定制浏览器窗口的大小。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> d = <span class="keyword">new</span> Dimension(<span class="number">320</span>, <span class="number">480</span>);</span><br><span class="line">driver.manage().window().setSize(d);</span><br><span class="line">driver.manage().window().setSize(<span class="keyword">new</span> Dimension(<span class="number">320</span>, <span class="number">480</span>));</span><br></pre></td></tr></table></figure>

<p>setPosition()：移动浏览器左上角到指定位置。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> p = <span class="keyword">new</span> Point(<span class="number">200</span>, <span class="number">200</span>);</span><br><span class="line">driver.manage().window().setPosition(p);</span><br><span class="line">driver.manage().window().setPosition(<span class="keyword">new</span> Point(<span class="number">300</span>, <span class="number">150</span>));</span><br></pre></td></tr></table></figure>

<p>getWindowHandle()：返回当前浏览器窗口。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> parentwindow = driver.getWindowHandle();</span><br><span class="line">driver.switchTo().window(parentwindow);</span><br></pre></td></tr></table></figure>

<p>getWindowHandles()：返回所有浏览器窗口。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> childwindows =  driver.getWindowHandles();</span><br><span class="line">driver.switchTo().window(childwindow);</span><br></pre></td></tr></table></figure>

<p>switchTo.window()：在浏览器窗口之间切换。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">driver.SwitchTo().Window(childwindow);</span><br><span class="line">driver.close();</span><br><span class="line">driver.SwitchTo().Window(parentWindow);</span><br></pre></td></tr></table></figure>

<h3 id="弹出窗口"><a href="#弹出窗口" class="headerlink" title="弹出窗口"></a>弹出窗口</h3><p>以下方法处理浏览器的弹出窗口。</p>
<p>dismiss() ：关闭弹出窗口。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> alert = driver.switchTo().alert();</span><br><span class="line">alert.dismiss();</span><br></pre></td></tr></table></figure>

<p>accept()：接受弹出窗口，相当于按下接受OK按钮。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> alert = driver.switchTo().alert();</span><br><span class="line">alert.accept();</span><br></pre></td></tr></table></figure>

<p>getText()：返回弹出窗口的文本值。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> alert = driver.switchTo().alert();</span><br><span class="line">alert.getText();</span><br></pre></td></tr></table></figure>

<p>sendKeys()：向弹出窗口发送文本字符串。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> alert = driver.switchTo().alert();</span><br><span class="line">alert.sendKeys(<span class="string">"Text to be passed"</span>);</span><br></pre></td></tr></table></figure>

<p>authenticateUsing()：处理HTTP认证。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> user = <span class="keyword">new</span> UserAndPassword(<span class="string">"USERNAME"</span>, <span class="string">"PASSWORD"</span>);</span><br><span class="line">alert.authenticateUsing(user);</span><br></pre></td></tr></table></figure>

<h3 id="鼠标和键盘的方法"><a href="#鼠标和键盘的方法" class="headerlink" title="鼠标和键盘的方法"></a>鼠标和键盘的方法</h3><p>以下方法模拟鼠标和键盘的动作。</p>
<ul>
<li>click()：鼠标在当前位置点击。</li>
<li>clickAndHold()：按下鼠标不放</li>
<li>contextClick()：右击鼠标</li>
<li>doubleClick()：双击鼠标</li>
<li>dragAndDrop()：鼠标拖放到目标元素</li>
<li>dragAndDropBy()：鼠标拖放到目标坐标</li>
<li>keyDown()：按下某个键</li>
<li>keyUp()：从按下状态释放某个键</li>
<li>moveByOffset()：移动鼠标到另一个坐标位置</li>
<li>moveToElement()：移动鼠标到另一个网页元素</li>
<li>release()：释放拖拉的元素</li>
<li>sendKeys()：控制键盘输出</li>
</ul>
<h2 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h2><ul>
<li>Jani Hartikainen, <a href="http://www.sitepoint.com/promises-in-javascript-unit-tests-the-definitive-guide/" target="_blank" rel="noopener">http://www.sitepoint.com/promises-in-javascript-unit-tests-the-definitive-guide/</a></li>
</ul>
</div><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:tty8128@outlook.com">8128</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://8128.me/2020/03/26/JS%E6%B5%8B%E8%AF%95%E6%95%99%E7%A8%8B/">http://8128.me/2020/03/26/JS%E6%B5%8B%E8%AF%95%E6%95%99%E7%A8%8B/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://8128.me" target="_blank">8128's Blog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/tutorial/">tutorial</a><a class="post-meta__tags" href="/tags/code/">code</a><a class="post-meta__tags" href="/tags/javascript/">javascript</a></div><div class="post_share"><div class="social-share" data-image="https://raw.githubusercontent.com/8128/PicGo/master/20200413234932.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"/><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js"></script></div></div><div class="post-reward"><a class="reward-button button--primary button--animated"> <i class="fa fa-qrcode"></i> 打赏<div class="reward-main"><ul class="reward-all"><li class="reward-item"><img class="lazyload post-qr-code__img" src="/img/wechat.jpg" alt="微信"/><div class="post-qr-code__desc">微信</div></li><li class="reward-item"><img class="lazyload post-qr-code__img" src="/img/alipay.jpg" alt="支付寶"/><div class="post-qr-code__desc">支付寶</div></li></ul></div></a></div><nav class="pagination_post" id="pagination"><div class="prev-post pull_left"><a href="/2020/03/26/Mac%E5%A4%9AJava%E7%89%88%E6%9C%AC%E7%AE%A1%E7%90%86/"><img class="prev_cover lazyload" data-src="https://raw.githubusercontent.com/8128/PicGo/master/20200326171714.png" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">Mac多Java版本管理</div></div></a></div><div class="next-post pull_right"><a href="/2020/03/25/ES6%E7%89%B9%E6%80%A7%E7%AC%94%E8%AE%B0/"><img class="next_cover lazyload" data-src="https://raw.githubusercontent.com/8128/PicGo/master/20200325213740.png" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">ES6特性笔记</div></div></a></div></nav><div class="relatedPosts"><div class="relatedPosts_headline"><i class="fa fa-fw fa-thumbs-up" aria-hidden="true"></i><span> 相关推荐</span></div><div class="relatedPosts_list"><div class="relatedPosts_item"><a href="/2020/04/10/TypeScript数据结构/" title="TypeScript数据结构"><img class="relatedPosts_cover lazyload"data-src="https://raw.githubusercontent.com/8128/PicGo/master/20200401004938.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2020-04-10</div><div class="relatedPosts_title">TypeScript数据结构</div></div></a></div><div class="relatedPosts_item"><a href="/2020/04/06/JavaScript-Rosie快速上手/" title="JavaScript Rosie快速上手"><img class="relatedPosts_cover lazyload"data-src="https://raw.githubusercontent.com/8128/PicGo/master/20200406155734.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2020-04-06</div><div class="relatedPosts_title">JavaScript Rosie快速上手</div></div></a></div><div class="relatedPosts_item"><a href="/2020/03/30/自学Node.JS笔记/" title="自学Node.JS笔记"><img class="relatedPosts_cover lazyload"data-src="https://raw.githubusercontent.com/8128/PicGo/master/20200321225737.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2020-03-30</div><div class="relatedPosts_title">自学Node.JS笔记</div></div></a></div><div class="relatedPosts_item"><a href="/2020/03/29/Grunt教程/" title="Grunt教程"><img class="relatedPosts_cover lazyload"data-src="https://raw.githubusercontent.com/8128/PicGo/master/20200329183951.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2020-03-29</div><div class="relatedPosts_title">Grunt教程</div></div></a></div><div class="relatedPosts_item"><a href="/2020/03/25/JS异步讲解-Asynchronous JavaScript/" title="JS异步讲解-Asynchronous JavaScript"><img class="relatedPosts_cover lazyload"data-src="https://raw.githubusercontent.com/8128/PicGo/master/20200322203138.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2020-03-25</div><div class="relatedPosts_title">JS异步讲解-Asynchronous JavaScript</div></div></a></div><div class="relatedPosts_item"><a href="/2020/03/22/入门JavaScript笔记/" title="入门JavaScript笔记"><img class="relatedPosts_cover lazyload"data-src="https://raw.githubusercontent.com/8128/PicGo/master/20200322203138.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2020-03-22</div><div class="relatedPosts_title">入门JavaScript笔记</div></div></a></div></div><div class="clear_both"></div></div><hr><div id="post-comment"><div class="comment_headling"><i class="fa fa-comments fa-fw" aria-hidden="true"></i><span> 评论</span></div><div id="disqus_thread"></div><script>var disqus_config = function () {
  this.page.url = 'http://8128.me/2020/03/26/JS%E6%B5%8B%E8%AF%95%E6%95%99%E7%A8%8B/';
  this.page.identifier = '2020/03/26/JS测试教程/';
  this.page.title = 'JS测试教程';
};
(function() { 
  var d = document, s = d.createElement('script');
  s.src = 'https://8128g.disqus.com/embed.js';
  s.setAttribute('data-timestamp', +new Date());
  (d.head || d.body).appendChild(s);
})();
</script></div></article></main><footer id="footer" data-type="color"><div id="footer-wrap"><div class="copyright">&copy;2020 By 8128</div><div class="framework-info"><span>驱动 </span><a href="https://hexo.io" target="_blank" rel="noopener"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 </span><a href="https://github.com/jerryc127/hexo-theme-butterfly" target="_blank" rel="noopener"><span>Butterfly</span></a></div><div class="footer_custom_text">Hi, welcome to my <a href="http://8128.me/">blog</a>!</div></div></footer></div><section class="rightside" id="rightside"><div id="rightside-config-hide"><i class="fa fa-book" id="readmode" title="阅读模式"></i><i class="fa fa-plus" id="font_plus" title="放大字体"></i><i class="fa fa-minus" id="font_minus" title="缩小字体"></i><a class="translate_chn_to_cht" id="translateLink" href="javascript:translatePage();" title="简繁转换" target="_self">繁</a><i class="darkmode fa fa-moon-o" id="darkmode" title="夜间模式"></i></div><div id="rightside-config-show"><div id="rightside_config" title="设置"><i class="fa fa-cog" aria-hidden="true"></i></div><a id="to_comment" href="#post-comment" title="直达评论"><i class="scroll_to_comment fa fa-comments">  </i></a><i class="fa fa-list-ul close" id="mobile-toc-button" title="目录" aria-hidden="true"></i><i class="fa fa-arrow-up" id="go-up" title="回到顶部" aria-hidden="true"></i></div></section><div class="search-dialog" id="local-search"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div></div><hr/><div id="local-search-results"><div id="local-hits"></div><div id="local-stats"><div class="local-search-stats__hr" id="hr"><span>由</span> <a href="https://github.com/wzpan/hexo-generator-search" target="_blank" rel="noopener" style="color:#49B1F5;">hexo-generator-search</a>
 <span>提供支持</span></div></div></div><span class="search-close-button"><i class="fa fa-times"></i></span></div><div class="search-mask"></div><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@latest/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/lazysizes@latest/lazysizes.min.js" async=""></script><script src="/js/search/local-search.js"></script></body></html>
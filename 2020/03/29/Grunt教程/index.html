<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Grunt教程 | 8128's Blog</title><meta name="description" content="JavaScript 世界的构建工具"><meta name="keywords" content="tutorial,code,javascript"><meta name="author" content="8128,tty8128@outlook.com"><meta name="copyright" content="8128"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="/img/favicon.ico"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="crossorigin"/><link rel="preconnect" href="https://fonts.googleapis.com" crossorigin="crossorigin"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta name="twitter:card" content="summary"><meta name="twitter:title" content="Grunt教程"><meta name="twitter:description" content="JavaScript 世界的构建工具"><meta name="twitter:image" content="https://raw.githubusercontent.com/8128/PicGo/master/20200329183951.png"><meta property="og:type" content="article"><meta property="og:title" content="Grunt教程"><meta property="og:url" content="http://8128.me/2020/03/29/Grunt%E6%95%99%E7%A8%8B/"><meta property="og:site_name" content="8128's Blog"><meta property="og:description" content="JavaScript 世界的构建工具"><meta property="og:image" content="https://raw.githubusercontent.com/8128/PicGo/master/20200329183951.png"><script src="https://cdn.jsdelivr.net/npm/js-cookie/dist/js.cookie.min.js"></script><script>var autoChangeMode = '1'
var t = Cookies.get("theme")
if (autoChangeMode == '1'){
  var isDarkMode = window.matchMedia("(prefers-color-scheme: dark)").matches
  var isLightMode = window.matchMedia("(prefers-color-scheme: light)").matches
  var isNotSpecified = window.matchMedia("(prefers-color-scheme: no-preference)").matches
  var hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

  if (t === undefined){
    if (isLightMode) activateLightMode()
    else if (isDarkMode) activateDarkMode()
    else if (isNotSpecified || hasNoSupport){
      console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
      var now = new Date()
      var hour = now.getHours()
      var isNight = hour < 6 || hour >= 18
      isNight ? activateDarkMode() : activateLightMode()
  }
  } else if (t == 'light') activateLightMode()
  else activateDarkMode()

} else if (autoChangeMode == '2'){
  now = new Date();
  hour = now.getHours();
  isNight = hour < 6 || hour >= 18
  if(t === undefined) isNight? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode() 
} else {
  if ( t == 'dark' ) activateDarkMode()
  else if ( t == 'light') activateLightMode()
}

function activateDarkMode(){
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null){
    document.querySelector('meta[name="theme-color"]').setAttribute('content','#000')
  }
}
function activateLightMode(){
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null){
  document.querySelector('meta[name="theme-color"]').setAttribute('content','#fff')
  }
}</script><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css"><link rel="canonical" href="http://8128.me/2020/03/29/Grunt%E6%95%99%E7%A8%8B/"><link rel="prev" title="Thrustmaster T150简评" href="http://8128.me/2020/03/30/Thrustmaster%20T150%E7%AE%80%E8%AF%84/"><link rel="next" title="MacOS关闭鼠标加速" href="http://8128.me/2020/03/29/MacOS%E5%85%B3%E9%97%AD%E9%BC%A0%E6%A0%87%E5%8A%A0%E9%80%9F/"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/disqusjs@1.2/dist/disqusjs.css"><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-158741918-1', 'auto');
ga('send', 'pageview');
</script><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容:${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"cookieDomain":"http://8128.me/","msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  bookmark: {
    message_prev: '按',
    message_next: '键将本页加入书签'
  },
  runtime_unit: '天',
  runtime: true,
  copyright: undefined,
  ClickShowText: undefined,
  medium_zoom: false,
  fancybox: true,
  Snackbar: {"bookmark":{"message_prev":"按","message_next":"键将本页加入书签"},"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#2d3035","position":"bottom-left"},
  baiduPush: false,
  highlightCopy: true,
  highlightLang: true,
  highlightShrink: 'false',
  isFontAwesomeV5: false,
  isPhotoFigcaption: false
  
}</script><script>var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isSidebar: true  
  }</script><noscript><style>
#page-header {
  opacity: 1
}
.justified-gallery img{
  opacity: 1
}
</style></noscript><meta name="generator" content="Hexo 4.2.0"></head><body><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="/img/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">48</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">标签</div><div class="length_num">29</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">分类</div><div class="length_num">11</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> Link</span></a></div></div></div></div><i class="fa fa-arrow-right on" id="toggle-sidebar" aria-hidden="true">     </i><div id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Grunt是什么"><span class="toc-text">Grunt是什么</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#简单入门"><span class="toc-text">简单入门</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#快速入门"><span class="toc-text">快速入门</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#环境"><span class="toc-text">环境</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#安装CLI"><span class="toc-text">安装CLI</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#CLI-是如何工作的"><span class="toc-text">CLI 是如何工作的</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#拿一份现有的-Grunt-项目练手"><span class="toc-text">拿一份现有的 Grunt 项目练手</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#准备一份新的-Grunt-项目"><span class="toc-text">准备一份新的 Grunt 项目</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#package-json"><span class="toc-text">package.json</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#安装Grunt-和-grunt插件"><span class="toc-text">安装Grunt 和 grunt插件</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Gruntfile"><span class="toc-text">Gruntfile</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Gruntfile文件案例"><span class="toc-text">Gruntfile文件案例</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#“wrapper”-函数"><span class="toc-text">“wrapper” 函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#项目和任务配置"><span class="toc-text">项目和任务配置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#加载-Grunt-插件和任务"><span class="toc-text">加载 Grunt 插件和任务</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#自定义任务"><span class="toc-text">自定义任务</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#配置任务"><span class="toc-text">配置任务</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Grunt配置"><span class="toc-text">Grunt配置</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#任务配置和目标"><span class="toc-text">任务配置和目标</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#options属性"><span class="toc-text">options属性</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#文件"><span class="toc-text">文件</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Difference-Between-Grunt-and-Task-Options"><span class="toc-text">Difference Between Grunt and Task Options</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#简洁格式"><span class="toc-text">简洁格式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#文件对象格式"><span class="toc-text">文件对象格式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#文件数组格式"><span class="toc-text">文件数组格式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#较老的格式"><span class="toc-text">较老的格式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#自定义过滤函数"><span class="toc-text">自定义过滤函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#通配符模式"><span class="toc-text">通配符模式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#动态构建文件对象"><span class="toc-text">动态构建文件对象</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#The-rename-Property"><span class="toc-text">The rename Property</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#模板"><span class="toc-text">模板</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#导入外部数据"><span class="toc-text">导入外部数据</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Gruntfile-实例"><span class="toc-text">Gruntfile 实例</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Requirements"><span class="toc-text">Requirements</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Setting-up-the-Gruntfile"><span class="toc-text">Setting up the Gruntfile</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#创建任务"><span class="toc-text">创建任务</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#任务别名"><span class="toc-text">任务别名</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#多任务"><span class="toc-text">多任务</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#“基本”-任务"><span class="toc-text">“基本” 任务</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#自定义任务-1"><span class="toc-text">自定义任务</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#CLI-参数-环境"><span class="toc-text">CLI 参数 &#x2F; 环境</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#为什么我的异步task没有完成？"><span class="toc-text">为什么我的异步task没有完成？</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#创建插件"><span class="toc-text">创建插件</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#注意"><span class="toc-text">注意</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#命名你的task"><span class="toc-text">命名你的task</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#调试"><span class="toc-text">调试</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#存储任务文件"><span class="toc-text">存储任务文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#避免改变当前工作目录：process-cwd"><span class="toc-text">避免改变当前工作目录：process.cwd()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Creating-your-task"><span class="toc-text">Creating your task</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#使用命令行工具"><span class="toc-text">使用命令行工具</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#安装命令行工具"><span class="toc-text">安装命令行工具</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#–help-h"><span class="toc-text">–help, -h</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#–base-b"><span class="toc-text">–base, -b</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#–no-color"><span class="toc-text">–no-color</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#–gruntfile"><span class="toc-text">–gruntfile</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#–debug-d"><span class="toc-text">–debug, -d</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#–stack"><span class="toc-text">–stack</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#–force-f"><span class="toc-text">–force, -f</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#–tasks"><span class="toc-text">–tasks</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#–npm"><span class="toc-text">–npm</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#–no-write"><span class="toc-text">–no-write</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#–verbose-v"><span class="toc-text">–verbose, -v</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#–version-V"><span class="toc-text">–version, -V</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#–completion"><span class="toc-text">–completion</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#–require"><span class="toc-text">–require</span></a></li></ol></li></ol></li></ol></div></div></div><div id="body-wrap"><div class="post-bg" id="nav" style="background-image: url(https://raw.githubusercontent.com/8128/PicGo/master/20200329183951.png)"><div id="page-header"><span class="pull_left" id="blog_name"><a class="blog_title" id="site-name" href="/">8128's Blog</a></span><span class="pull_right menus"><div id="search_button"><a class="site-page social-icon search"><i class="fa fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> Link</span></a></div></div><span class="toggle-menu close"><a class="site-page"><i class="fa fa-bars fa-fw" aria-hidden="true"></i></a></span></span></div><div id="post-info"><div id="post-title"><div class="posttitle">Grunt教程</div></div><div id="post-meta"><div class="meta-firstline"><time class="post-meta__date"><span class="post-meta__date-created" title="发表于 2020-03-29 16:34:46"><i class="fa fa-calendar" aria-hidden="true"></i> 发表于 2020-03-29</span><span class="post-meta__separator">|</span><span class="post-meta__date-updated" title="更新于 2020-03-29 23:08:41"><i class="fa fa-history" aria-hidden="true"></i> 更新于 2020-03-29</span></time><span class="post-meta__categories"><span class="post-meta__separator">|</span><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/javascript/">javascript</a></span></div><div class="meta-secondline"> <span class="post-meta-wordcount"><i class="post-meta__icon fa fa-file-word-o" aria-hidden="true"></i><span>字数总计:</span><span class="word-count">10.6k</span><span class="post-meta__separator">|</span><i class="post-meta__icon fa fa-clock-o" aria-hidden="true"></i><span>阅读时长: 45 分钟</span></span></div><div class="meta-thirdline"><span class="post-meta-pv-cv"><span class="post-meta__separator">|</span><i class="fa fa-eye post-meta__icon" aria-hidden="true"> </i><span>阅读量:</span><span id="busuanzi_value_page_pv"></span></span><span class="post-meta-commentcount"></span></div></div></div></div><main class="layout_post" id="content-inner"><article id="post"><div id="article-container"><p>部分来源：<a href="www.gruntjs.net/">Grunt中文网</a></p>
<h1 id="Grunt是什么"><a href="#Grunt是什么" class="headerlink" title="Grunt是什么"></a>Grunt是什么</h1><p>Grunt是一款构建工具，为了让程序自动化而生。对于需要反复重复的任务，例如压缩（minification）、编译、单元测试、linting等，自动化工具可以减轻你的劳动，简化你的工作。当你在 <a href="https://www.gruntjs.net/sample-gruntfile" target="_blank" rel="noopener">Gruntfile</a> 文件正确配置好了任务，任务运行器就会自动帮你或你的小组完成大部分无聊的工作。</p>
<h1 id="简单入门"><a href="#简单入门" class="headerlink" title="简单入门"></a>简单入门</h1><p>这部分入门是我自己写的简单入门，官方的快速入门在下面。</p>
<p>假如你想要用grunt，首先你需要npm，然后在你的package下安装grunt，然后建立一个<code>Gruntfile.js</code>文件，在文件中写你的grunt设置。grunt会根据你的<code>Gruntfile.js</code>来运作，例如：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = <span class="function"><span class="keyword">function</span>(<span class="params">grunt</span>) </span>&#123;</span><br><span class="line">  grunt.registerTask(<span class="string">'speak'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"I'm speaking"</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">  </span><br><span class="line">  grunt.registerTask(<span class="string">'yell'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"I'm Yelling"</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">  </span><br><span class="line">  grunt.registerTask(<span class="string">'cool'</span>, [<span class="string">'speak'</span>, <span class="string">'yell'</span>]);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>这时假如你在命令行中输入就可以调用其中regist过的方法</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">$ grunt speak</span><br><span class="line"></span><br><span class="line">I<span class="string">'m speaking</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">$ grunt yell</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">I'</span>m Yelling</span><br><span class="line"></span><br><span class="line">$ grunt yell</span><br><span class="line"></span><br><span class="line">I<span class="string">'m speaking</span></span><br><span class="line"><span class="string">I'</span>m Yelling</span><br></pre></td></tr></table></figure>

<p>grunt还支持大量的plugin，你可以在<a href="https://gruntjs.com/plugins" target="_blank" rel="noopener">这里</a>查到，其中会有用法介绍。你在安装这些predefined task之后，它们可能需要project中的设置才能够运行。为此我们需要initConfig，长相可能如下</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">grunt.initConfig(&#123;</span><br><span class="line">    pkg: grunt.file.readJSON(<span class="string">'package.json'</span>),</span><br><span class="line">    uglify: &#123;</span><br><span class="line">      options: &#123;</span><br><span class="line">        banner: <span class="string">'/*! &lt;%= pkg.name %&gt; &lt;%= grunt.template.today("yyyy-mm-dd") %&gt; */\n'</span></span><br><span class="line">      &#125;,</span><br><span class="line">      build: &#123;</span><br><span class="line">        src: <span class="string">'src/&lt;%= pkg.name %&gt;.js'</span>,</span><br><span class="line">        dest: <span class="string">'build/&lt;%= pkg.name %&gt;.min.js'</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure>

<p>根据不同的预设plugin，我们可能需要更改initConfig。举例，假使我们在使用concat的plugin，我们首先用<code>npm install grunt-contrib-concat --save-dev</code>安装concat插件，然后在<code>Gruntfile.js</code>中用<code>grunt.loadNpmTasks(&#39;grunt-contrib-concat&#39;)</code>导入这个模块。因为我们导入了这个模块，模块运行需要我们的project设置，所以我们到concat的官方GitHub上copy下官方config，略作修改，在之前写入initConfig如下</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = <span class="function"><span class="keyword">function</span>(<span class="params">grunt</span>) </span>&#123;</span><br><span class="line">  grunt.initConfig(&#123;</span><br><span class="line">    concat: &#123;</span><br><span class="line">      <span class="comment">//options: &#123;</span></span><br><span class="line">      <span class="comment">//  separator: ';',</span></span><br><span class="line">      <span class="comment">//&#125;,</span></span><br><span class="line">      dist: &#123; <span class="comment">//distribution可以被改成任何东西，你可以叫其他名字</span></span><br><span class="line">        src: [<span class="string">'src/intro.js'</span>, <span class="string">'src/project.js'</span>, <span class="string">'src/outro.js'</span>],</span><br><span class="line">        dest: <span class="string">'dist/built.js'</span>,</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;);</span><br><span class="line">  </span><br><span class="line">  grunt.loadNpmTasks(<span class="string">'grunt-contrib-concat); // 会自动寻找config中的concat部分</span></span><br><span class="line"><span class="string">&#125;;</span></span><br></pre></td></tr></table></figure>

<p>这时：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ grunt concat</span><br><span class="line">File dist/built.js created.</span><br></pre></td></tr></table></figure>

<p>假如我们有两个任务</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = <span class="function"><span class="keyword">function</span>(<span class="params">grunt</span>) </span>&#123;</span><br><span class="line">  grunt.initConfig(&#123;</span><br><span class="line">      concat:&#123;</span><br><span class="line">        aa: &#123; <span class="comment">//distribution可以被改成任何东西，你可以叫其他名字</span></span><br><span class="line">          src: [<span class="string">'src/intro.js'</span>, <span class="string">'src/project.js'</span>, <span class="string">'src/outro.js'</span>],</span><br><span class="line">          dest: <span class="string">'dist/built.js'</span>,</span><br><span class="line">        &#125;,</span><br><span class="line">        bb: &#123; </span><br><span class="line">          src: [<span class="string">'src/intro1.js'</span>, <span class="string">'src/project1.js'</span>, <span class="string">'src/outro1.js'</span>],</span><br><span class="line">          dest: <span class="string">'dist/built1.js'</span>,</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;);</span><br><span class="line">  </span><br><span class="line">  grunt.loadNpmTasks(<span class="string">'grunt-contrib-concat); // 会自动寻找config中的concat部分</span></span><br><span class="line"><span class="string">&#125;;</span></span><br></pre></td></tr></table></figure>

<p>那么运行<code>grunt concat</code>，会合并你所有的文件</p>
<h1 id="快速入门"><a href="#快速入门" class="headerlink" title="快速入门"></a>快速入门</h1><h2 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h2><p>Grunt和 Grunt 插件是通过 <a href="https://www.npmjs.org/" target="_blank" rel="noopener">npm</a> 安装并管理的，npm是 <a href="https://nodejs.org/" target="_blank" rel="noopener">Node.js</a> 的包管理器。</p>
<p>Grunt 0.4.x 必须配合 Node.js <code>&gt;= 0.8.0</code> 版本使用。</p>
<p>在安装 Grunt 前，请确保当前环境中所安装的 <a href="https://www.npmjs.org/" target="_blank" rel="noopener">npm</a> 已经是最新版本，执行 <code>npm update -g npm</code> 指令进行升级（在某些系统中可能需要 <code>sudo</code> 指令）。</p>
<p>如果你已经安装了 Grunt，现在需要参考一些文档手册，那就请看一看 <a href="https://gruntjs.net/sample-gruntfile" target="_blank" rel="noopener"><code>Gruntfile</code> 实例</a> 和如何 <a href="https://gruntjs.net/configuring-tasks" target="_blank" rel="noopener">配置任务</a>吧。</p>
<h2 id="安装CLI"><a href="#安装CLI" class="headerlink" title="安装CLI"></a>安装CLI</h2><p><strong>还在使用 Grunt 0.3 版本吗？请查看 <a href="https://www.gruntjs.net/upgrading-from-0.3-to-0.4#grunt-0.3-notes" target="_blank" rel="noopener">Grunt 0.3 注意事项</a></strong></p>
<p>在继续学习前，你需要先将Grunt命令行（CLI）安装到全局环境中。安装时可能需要使用sudo（针对OSX、*nix、BSD等系统中）权限或者作为管理员（对于Windows环境）来执行以下命令。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install -g grunt-cli</span><br></pre></td></tr></table></figure>

<p>上述命令执行完后，<code>grunt</code> 命令就被加入到你的系统路径中了，以后就可以在任何目录下执行此命令了。</p>
<p>注意，安装<code>grunt-cli</code>并不等于安装了 Grunt！Grunt CLI的任务很简单：调用与<code>Gruntfile</code>在同一目录中 Grunt。这样带来的好处是，允许你在同一个系统上同时安装多个版本的 Grunt。</p>
<p>这样就能让多个版本的 Grunt 同时安装在同一台机器上。</p>
<h2 id="CLI-是如何工作的"><a href="#CLI-是如何工作的" class="headerlink" title="CLI 是如何工作的"></a>CLI 是如何工作的</h2><p>每次运行<code>grunt</code> 时，他就利用node提供的<code>require()</code>系统查找本地安装的 Grunt。正是由于这一机制，你可以在项目的任意子目录中运行<code>grunt</code> 。</p>
<p>如果找到一份本地安装的 Grunt，CLI就将其加载，并传递<code>Gruntfile</code>中的配置信息，然后执行你所指定的任务。为了更好的理解 Grunt CLI的执行原理，请<a href="https://github.com/gruntjs/grunt-cli/blob/master/bin/grunt" target="_blank" rel="noopener">阅读源码</a>。</p>
<h2 id="拿一份现有的-Grunt-项目练手"><a href="#拿一份现有的-Grunt-项目练手" class="headerlink" title="拿一份现有的 Grunt 项目练手"></a>拿一份现有的 Grunt 项目练手</h2><p>假定Grunt CLI已经正确安装，并且已经有一份配置好<code>package.json</code> 和 <code>Gruntfile</code> 文件的项目了，接下来就很容易拿Grunt练手了：</p>
<ol>
<li>将命令行的当前目录转到项目的根目录下。</li>
<li>执行<code>npm install</code>命令安装项目依赖的库。</li>
<li>执行 <code>grunt</code> 命令。</li>
</ol>
<p>OK，就是这么简单。还可以通过<code>grunt --help</code> 命令列出所有已安装的Grunt任务（task），但是一般更建议去查看项目的文档以获取帮助信息。</p>
<h2 id="准备一份新的-Grunt-项目"><a href="#准备一份新的-Grunt-项目" class="headerlink" title="准备一份新的 Grunt 项目"></a>准备一份新的 Grunt 项目</h2><p>一般需要在你的项目中添加两份文件：<code>package.json</code> 和 <code>Gruntfile</code>。</p>
<p><strong>package.json</strong>: 此文件被<a href="https://www.npmjs.org/" target="_blank" rel="noopener">npm</a>用于存储项目的元数据，以便将此项目发布为npm模块。你可以在此文件中列出项目依赖的grunt和Grunt插件，放置于<a href="https://docs.npmjs.com/files/package.json#devdependencies" target="_blank" rel="noopener">devDependencies</a>配置段内。</p>
<p><strong>Gruntfile</strong>: 此文件被命名为 <code>Gruntfile.js</code> 或 <code>Gruntfile.coffee</code>，用来配置或定义任务（task）并加载Grunt插件的。 <strong>此文档中提到的 <code>Gruntfile</code> 其实说的是一个文件，文件名是 <code>Gruntfile.js</code> 或 <code>Gruntfile.coffee</code></strong>。</p>
<h2 id="package-json"><a href="#package-json" class="headerlink" title="package.json"></a>package.json</h2><p><code>package.json</code>应当放置于项目的根目录中，与<code>Gruntfile</code>在同一目录中，并且应该与项目的源代码一起被提交。在上述目录(<code>package.json</code>所在目录)中运行<code>npm install</code>将依据<code>package.json</code>文件中所列出的每个依赖来自动安装适当版本的依赖。</p>
<p>下面列出了几种为你的项目创建<code>package.json</code>文件的方式：</p>
<ul>
<li>大部分 <a href="https://www.gruntjs.net/project-scaffolding" target="_blank" rel="noopener">grunt-init</a> 模版都会自动创建特定于项目的<code>package.json</code>文件。</li>
<li><a href="https://docs.npmjs.com/cli/init" target="_blank" rel="noopener">npm init</a>命令会创建一个基本的<code>package.json</code>文件。</li>
<li>复制下面的案例，并根据需要做扩充，参考此<a href="https://docs.npmjs.com/files/package.json" target="_blank" rel="noopener">说明</a>.</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">"name"</span>: <span class="string">"my-project-name"</span>,</span><br><span class="line">  <span class="string">"version"</span>: <span class="string">"0.1.0"</span>,</span><br><span class="line">  <span class="string">"devDependencies"</span>: &#123;</span><br><span class="line">    <span class="string">"grunt"</span>: <span class="string">"~0.4.5"</span>,</span><br><span class="line">    <span class="string">"grunt-contrib-jshint"</span>: <span class="string">"~0.10.0"</span>,</span><br><span class="line">    <span class="string">"grunt-contrib-nodeunit"</span>: <span class="string">"~0.4.1"</span>,</span><br><span class="line">    <span class="string">"grunt-contrib-uglify"</span>: <span class="string">"~0.5.0"</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="安装Grunt-和-grunt插件"><a href="#安装Grunt-和-grunt插件" class="headerlink" title="安装Grunt 和 grunt插件"></a>安装Grunt 和 grunt插件</h3><p>向已经存在的<code>package.json</code> 文件中添加Grunt和grunt插件的最简单方式是通过<code>npm install  --save-dev</code>命令。此命令不光安装了``，还会自动将其添加到<a href="https://docs.npmjs.com/files/package.json#devdependencies" target="_blank" rel="noopener">devDependencies</a> 配置段中，遵循<a href="https://www.npmjs.org/doc/misc/semver.html#Ranges" target="_blank" rel="noopener">tilde version range</a>格式。</p>
<p>例如，下面这条命令将安装Grunt最新版本到项目目录中，并将其添加到devDependencies内：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install grunt --save-dev</span><br></pre></td></tr></table></figure>

<p>同样，grunt插件和其它node模块都可以按相同的方式安装。下面展示的实例就是安装 JSHint 任务模块：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install grunt-contrib-jshint --save-dev</span><br></pre></td></tr></table></figure>

<p>在 <a href="https://gruntjs.net/plugins" target="_blank" rel="noopener">Grunt 插件</a> 页面可以看到当前可用的 Grunt 插件，他们可以直接在项目中安装并使用。</p>
<p>安装插件之后，请务必确保将更新之后的 <code>package.json</code> 文件提交到项目仓库中。</p>
<h2 id="Gruntfile"><a href="#Gruntfile" class="headerlink" title="Gruntfile"></a>Gruntfile</h2><p><code>Gruntfile.js</code> 或 <code>Gruntfile.coffee</code> 文件是有效的 JavaScript 或 CoffeeScript 文件，应当放在你的项目根目录中，和<code>package.json</code>文件在同一目录层级，并和项目源码一起加入源码管理器。</p>
<p>Gruntfile由以下几部分构成：</p>
<ul>
<li>“wrapper” 函数</li>
<li>项目与任务配置</li>
<li>加载grunt插件和任务</li>
<li>自定义任务</li>
</ul>
<h3 id="Gruntfile文件案例"><a href="#Gruntfile文件案例" class="headerlink" title="Gruntfile文件案例"></a>Gruntfile文件案例</h3><p>在下面列出的这个 <code>Gruntfile</code> 中，<code>package.json</code>文件中的项目元数据（metadata）被导入到 Grunt 配置中， <a href="https://github.com/gruntjs/grunt-contrib-uglify" target="_blank" rel="noopener">grunt-contrib-uglify</a> 插件中的<code>uglify</code> 任务（task）被配置为压缩（minify）源码文件并依据上述元数据动态生成一个文件头注释。当在命令行中执行 <code>grunt</code> 命令时，<code>uglify</code> 任务将被默认执行。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = <span class="function"><span class="keyword">function</span>(<span class="params">grunt</span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Project configuration.</span></span><br><span class="line">  grunt.initConfig(&#123;</span><br><span class="line">    pkg: grunt.file.readJSON(<span class="string">'package.json'</span>),</span><br><span class="line">    uglify: &#123;</span><br><span class="line">      options: &#123;</span><br><span class="line">        banner: <span class="string">'/*! &lt;%= pkg.name %&gt; &lt;%= grunt.template.today("yyyy-mm-dd") %&gt; */\n'</span></span><br><span class="line">      &#125;,</span><br><span class="line">      build: &#123;</span><br><span class="line">        src: <span class="string">'src/&lt;%= pkg.name %&gt;.js'</span>,</span><br><span class="line">        dest: <span class="string">'build/&lt;%= pkg.name %&gt;.min.js'</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 加载包含 "uglify" 任务的插件。</span></span><br><span class="line">  grunt.loadNpmTasks(<span class="string">'grunt-contrib-uglify'</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 默认被执行的任务列表。</span></span><br><span class="line">  grunt.registerTask(<span class="string">'default'</span>, [<span class="string">'uglify'</span>]);</span><br><span class="line"></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>前面已经向你展示了整个 <code>Gruntfile</code>，接下来将详细解释其中的每一部分。</p>
<h3 id="“wrapper”-函数"><a href="#“wrapper”-函数" class="headerlink" title="“wrapper” 函数"></a>“wrapper” 函数</h3><p>每一份 <code>Gruntfile</code> （和grunt插件）都遵循同样的格式，你所书写的Grunt代码必须放在此函数内：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = <span class="function"><span class="keyword">function</span>(<span class="params">grunt</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// Do grunt-related things in here</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h3 id="项目和任务配置"><a href="#项目和任务配置" class="headerlink" title="项目和任务配置"></a>项目和任务配置</h3><p>大部分的Grunt任务都依赖某些配置数据，这些数据被定义在一个object内，并传递给<a href="https://www.gruntjs.net/grunt#grunt.initconfig" target="_blank" rel="noopener">grunt.initConfig</a> 方法。</p>
<p>在下面的案例中，<code>grunt.file.readJSON(&#39;package.json&#39;)</code> 将存储在<code>package.json</code>文件中的JSON元数据引入到grunt config中。 由于<code>&lt;% %&gt;</code>模板字符串可以引用任意的配置属性，因此可以通过这种方式来指定诸如文件路径和文件列表类型的配置数据，从而减少一些重复的工作。</p>
<p>你可以在这个配置对象中(传递给initConfig()方法的对象)存储任意的数据，只要它不与你任务配置所需的属性冲突，否则会被忽略。此外，由于这本身就是JavaScript，你不仅限于使用JSON；你可以在这里使用任意的有效的JS代码。如果有必要，你甚至可以以编程的方式生成配置。</p>
<p>与大多数task一样，<a href="https://github.com/gruntjs/grunt-contrib-uglify" target="_blank" rel="noopener">grunt-contrib-uglify</a> 插件中的<code>uglify</code> 任务要求它的配置被指定在一个同名属性中。在这里有一个例子, 我们指定了一个<code>banner</code>选项(用于在文件顶部生成一个注释)，紧接着是一个单一的名为<code>build</code>的uglify目标，用于将一个js文件压缩为一个目标文件。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Project configuration.</span></span><br><span class="line">grunt.initConfig(&#123;</span><br><span class="line">  pkg: grunt.file.readJSON(<span class="string">'package.json'</span>),</span><br><span class="line">  uglify: &#123;</span><br><span class="line">    options: &#123;</span><br><span class="line">      banner: <span class="string">'/*! &lt;%= pkg.name %&gt; &lt;%= grunt.template.today("yyyy-mm-dd") %&gt; */\n'</span></span><br><span class="line">    &#125;,</span><br><span class="line">    build: &#123;</span><br><span class="line">      src: <span class="string">'src/&lt;%= pkg.name %&gt;.js'</span>,</span><br><span class="line">      dest: <span class="string">'build/&lt;%= pkg.name %&gt;.min.js'</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="加载-Grunt-插件和任务"><a href="#加载-Grunt-插件和任务" class="headerlink" title="加载 Grunt 插件和任务"></a>加载 Grunt 插件和任务</h3><p>像 <a href="https://github.com/gruntjs/grunt-contrib-concat" target="_blank" rel="noopener">concatenation</a>、[minification]、<a href="https://github.com/gruntjs/grunt-contrib-uglify" target="_blank" rel="noopener">grunt-contrib-uglify</a> 和 <a href="https://github.com/gruntjs/grunt-contrib-jshint" target="_blank" rel="noopener">linting</a>这些常用的任务（task）都已经以<a href="https://github.com/gruntjs" target="_blank" rel="noopener">grunt插件</a>的形式被开发出来了。只要在 <code>package.json</code> 文件中被列为dependency（依赖）的包，并通过<code>npm install</code>安装之后，都可以在<code>Gruntfile</code>中以简单命令的形式使用：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 加载能够提供"uglify"任务的插件。</span></span><br><span class="line">grunt.loadNpmTasks(<span class="string">'grunt-contrib-uglify'</span>);</span><br></pre></td></tr></table></figure>

<p><strong>注意：</strong> <code>grunt --help</code> 命令将列出所有可用的任务。</p>
<h3 id="自定义任务"><a href="#自定义任务" class="headerlink" title="自定义任务"></a>自定义任务</h3><p>通过定义 <code>default</code> 任务，可以让Grunt默认执行一个或多个任务。在下面的这个案例中，执行 <code>grunt</code> 命令时如果不指定一个任务的话，将会执行<code>uglify</code>任务。这和执行<code>grunt uglify</code> 或者 <code>grunt default</code>的效果一样。<code>default</code>任务列表数组中可以指定任意数目的任务（可以带参数）。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Default task(s).</span></span><br><span class="line">grunt.registerTask(<span class="string">'default'</span>, [<span class="string">'uglify'</span>]);</span><br></pre></td></tr></table></figure>

<p>如果Grunt插件中的任务（task）不能满足你的项目需求，你还可以在<code>Gruntfile</code>中自定义任务（task）。例如，在下面的 <code>Gruntfile</code> 中自定义了一个<code>default</code> 任务，并且他甚至不依赖任务配置：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = <span class="function"><span class="keyword">function</span>(<span class="params">grunt</span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// A very basic default task.</span></span><br><span class="line">  grunt.registerTask(<span class="string">'default'</span>, <span class="string">'Log some stuff.'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    grunt.log.write(<span class="string">'Logging some stuff...'</span>).ok();</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>特定于项目的任务不必在 <code>Gruntfile</code> 中定义。他们可以定义在外部<code>.js</code> 文件中，并通过<a href="https://www.gruntjs.net/grunt/#grunt.loadtasks" target="_blank" rel="noopener">grunt.loadTasks</a> 方法加载。</p>
<h1 id="配置任务"><a href="#配置任务" class="headerlink" title="配置任务"></a>配置任务</h1><p>这个指南解释了如何使用 <code>Gruntfile</code> 来为你的项目配置task。如果你还不知道 <code>Gruntfile</code> 是什么，请先阅读 <a href="https://www.gruntjs.net/getting-started" target="_blank" rel="noopener">快速入门</a> 指南并看看这个<a href="https://www.gruntjs.net/sample-gruntfile" target="_blank" rel="noopener">Gruntfile 实例</a>。</p>
<h2 id="Grunt配置"><a href="#Grunt配置" class="headerlink" title="Grunt配置"></a>Grunt配置</h2><p>Grunt的task配置都是在 <code>Gruntfile</code> 中的<code>grunt.initConfig</code>方法中指定的。此配置主要是以任务名称命名的属性，也可以包含其他任意数据。一旦这些代表任意数据的属性与任务所需要的属性相冲突，就将被忽略。</p>
<p>此外，由于这本身就是JavaScript，因此你不仅限于使用JSON；你可以在这里使用任何有效的JavaScript。必要的情况下，你甚至可以以编程的方式生成配置。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">grunt.initConfig(&#123;</span><br><span class="line">  concat: &#123;</span><br><span class="line">    <span class="comment">// 这里是concat任务的配置信息。</span></span><br><span class="line">  &#125;,</span><br><span class="line">  uglify: &#123;</span><br><span class="line">    <span class="comment">// 这里是uglify任务的配置信息</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// 任意数据。</span></span><br><span class="line">  my_property: <span class="string">'whatever'</span>,</span><br><span class="line">  my_src_files: [<span class="string">'foo/*.js'</span>, <span class="string">'bar/*.js'</span>],</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="任务配置和目标"><a href="#任务配置和目标" class="headerlink" title="任务配置和目标"></a>任务配置和目标</h2><p>当运行一个任务时，Grunt会自动查找配置对象中的同名属性。多任务（multi-task）可以通过任意命名的“目标（target）”来定义多个配置。在下面的案例中，<code>concat</code>任务有名为<code>foo</code>和<code>bar</code>两个目标，而<code>uglify</code>任务仅仅只有一个名为<code>bar</code>目标。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">grunt.initConfig(&#123;</span><br><span class="line">  concat: &#123;</span><br><span class="line">    foo: &#123;</span><br><span class="line">      <span class="comment">// concat task "foo" target options and files go here.</span></span><br><span class="line">    &#125;,</span><br><span class="line">    bar: &#123;</span><br><span class="line">      <span class="comment">// concat task "bar" target options and files go here.</span></span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">  uglify: &#123;</span><br><span class="line">    bar: &#123;</span><br><span class="line">      <span class="comment">// uglify task "bar" target options and files go here.</span></span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>同时指定任务（task）和目标（target），例如<code>grunt concat:foo</code>或者<code>grunt concat:bar</code>，将只会处理指定目标（target）的配置，而运行<code>grunt concat</code>将遍历<em>所有</em>目标（target）并依次处理。注意，如果一个任务使用<a href="https://www.gruntjs.net/grunt.task#grunt.task.renametask" target="_blank" rel="noopener">grunt.task.renameTask</a>重命名过，Grunt将在配置对象中查找以<em>新的</em>任务名命名的属性。</p>
<h2 id="options属性"><a href="#options属性" class="headerlink" title="options属性"></a>options属性</h2><p>在一个任务配置中，<code>options</code>属性可以用来指定覆盖内置属性的默认值。此外，每一个目标（target）中还可以拥有一个专门针对此目标（target）的<code>options</code>属性。目标（target）级的平options将会覆盖任务级的options。</p>
<p><code>options</code>对象是可选的，如果不需要，可以忽略。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">grunt.initConfig(&#123;</span><br><span class="line">  concat: &#123;</span><br><span class="line">    options: &#123;</span><br><span class="line">      <span class="comment">// 这里是任务级的Options，覆盖默认值 </span></span><br><span class="line">    &#125;,</span><br><span class="line">    foo: &#123;</span><br><span class="line">      options: &#123;</span><br><span class="line">        <span class="comment">// "foo" target options may go here, overriding task-level options.</span></span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">    bar: &#123;</span><br><span class="line">      <span class="comment">// No options specified; this target will use task-level options.</span></span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="文件"><a href="#文件" class="headerlink" title="文件"></a>文件</h2><p>由于大多的任务都是执行文件操作，Grunt 有一个强大的抽象层用于声明任务应该操作哪些文件。这里有好几种定义<strong>src-dest</strong>(源文件-目标文件)文件映射的方式，均提供了不同程度的描述和控制操作方式。任何一种多任务（multi-task）都能理解下面的格式，所以你只需要选择满足你需求的格式就行。</p>
<p>All file formats support <code>src</code> and <code>dest</code> but the <a href="https://www.gruntjs.net/configuring-tasks#compact-format" target="_blank" rel="noopener">Compact</a> and <a href="https://www.gruntjs.net/configuring-tasks#files-array-format" target="_blank" rel="noopener">Files Array</a> formats support a few additional properties:</p>
<ul>
<li><code>filter</code> 它通过接受任意一个有效的<a href="https://nodejs.org/docs/latest/api/fs.html#fs_class_fs_stats" target="_blank" rel="noopener">fs.Stats方法名</a>或者一个函数来匹配<code>src</code>文件路径并根据匹配结果返回<code>true</code>或者<code>false</code>。 <a href="https://www.gruntjs.net/configuring-tasks#custom-filter-function" target="_blank" rel="noopener">See examples</a></li>
<li><code>nonull</code> 如果被设置为 <code>true</code>，未匹配的模式也将执行。结合Grunt的<code>--verbore</code>标志, 这个选项可以帮助用来调试文件路径的问题。</li>
<li><code>dot</code> 它允许模式模式匹配句点开头的文件名，即使模式并不明确文件名开头部分是否有句点。</li>
<li><code>matchBase</code>如果设置这个属性，缺少斜线的模式(意味着模式中不能使用斜线进行文件路径的匹配)将不会匹配包含在斜线中的文件名。 例如，<code>a?b</code> 将匹配 <code>/xyz/123/acb</code> 但不匹配 <code>/xyz/acb/123</code>。</li>
<li><code>expand</code> 处理动态的<code>src-dest</code>文件映射，更多的信息请查看<a href="https://www.gruntjs.net/configuring-tasks#building-the-files-object-dynamically" target="_blank" rel="noopener">动态构建文件对象</a>。</li>
<li>其他的属性将作为匹配项传递给底层的库。 请查看<a href="https://github.com/isaacs/node-glob" target="_blank" rel="noopener">node-glob</a> 和<a href="https://github.com/isaacs/minimatch" target="_blank" rel="noopener">minimatch</a> 文档以获取更多信息。</li>
</ul>
<h3 id="Difference-Between-Grunt-and-Task-Options"><a href="#Difference-Between-Grunt-and-Task-Options" class="headerlink" title="Difference Between Grunt and Task Options"></a>Difference Between Grunt and Task Options</h3><p>Most tasks perform file operations, so Grunt provides a built-in infrastructure to retrieve the files a task should process. The advantage is that this logic doesn’t have to be implemented again by tasks authors. To allow a user to specify these files, Grunt provides options such as <code>nonull</code> and <code>filter</code>.</p>
<p>In addition to the files to work on, each task has its own specific needs. A task author may want to allow its user to configure some options to override the default behavior. These task-specific options shall not be confused with the Grunt options described before.</p>
<p>To further clarify this difference, let’s see an example that uses <a href="https://github.com/gruntjs/grunt-contrib-jshint" target="_blank" rel="noopener">grunt-contrib-jshint</a>:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">grunt.initConfig(&#123;</span><br><span class="line">  jshint: &#123;</span><br><span class="line">    ignore_warning: &#123;</span><br><span class="line">      options: &#123;</span><br><span class="line">        <span class="string">'-W015'</span>: <span class="literal">true</span>,</span><br><span class="line">      &#125;,</span><br><span class="line">      src: <span class="string">'js/**'</span>,</span><br><span class="line">      filter: <span class="string">'isFile'</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>This configuration employs the Grunt options <code>src</code> and <code>filter</code> to specify the files to process. It also uses the grunt-contrib-jshint task-specific option <code>-W015</code> to ignore a specific warning (the one having code <code>W015</code>).</p>
<h3 id="简洁格式"><a href="#简洁格式" class="headerlink" title="简洁格式"></a>简洁格式</h3><p>这种形式允许每个目标对应一个<strong>src-dest</strong>文件映射。通常情况下它用于只读任务，比如<a href="https://github.com/gruntjs/grunt-contrib-jshint" target="_blank" rel="noopener">grunt-contrib-jshint</a>，它就只需要一个单一的<code>src</code>属性，而不需要关联的<code>dest</code>选项. 这种格式还支给每个<code>src-dest</code>文件映射指定额外的属性。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">grunt.initConfig(&#123;</span><br><span class="line">  jshint: &#123;</span><br><span class="line">    foo: &#123;</span><br><span class="line">      src: [<span class="string">'src/aa.js'</span>, <span class="string">'src/aaa.js'</span>]</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">  concat: &#123;</span><br><span class="line">    bar: &#123;</span><br><span class="line">      src: [<span class="string">'src/bb.js'</span>, <span class="string">'src/bbb.js'</span>],</span><br><span class="line">      dest: <span class="string">'dest/b.js'</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="文件对象格式"><a href="#文件对象格式" class="headerlink" title="文件对象格式"></a>文件对象格式</h3><p>这种形式支持每个目标对应多个<code>src-dest</code>形式的文件映射，属性名就是目标文件，源文件就是它的值(源文件列表则使用数组格式声明)。可以使用这种方式指定数个<code>src-dest</code>文件映射， 但是不能够给每个映射指定附加的属性。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">grunt.initConfig(&#123;</span><br><span class="line">  concat: &#123;</span><br><span class="line">    foo: &#123;</span><br><span class="line">      files: &#123;</span><br><span class="line">        <span class="string">'dest/a.js'</span>: [<span class="string">'src/aa.js'</span>, <span class="string">'src/aaa.js'</span>],</span><br><span class="line">        <span class="string">'dest/a1.js'</span>: [<span class="string">'src/aa1.js'</span>, <span class="string">'src/aaa1.js'</span>],</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">    bar: &#123;</span><br><span class="line">      files: &#123;</span><br><span class="line">        <span class="string">'dest/b.js'</span>: [<span class="string">'src/bb.js'</span>, <span class="string">'src/bbb.js'</span>],</span><br><span class="line">        <span class="string">'dest/b1.js'</span>: [<span class="string">'src/bb1.js'</span>, <span class="string">'src/bbb1.js'</span>],</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="文件数组格式"><a href="#文件数组格式" class="headerlink" title="文件数组格式"></a>文件数组格式</h3><p>这种形式支持每个目标对应多个<code>src-dest</code>文件映射，同时也允许每个映射拥有额外属性：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">grunt.initConfig(&#123;</span><br><span class="line">  concat: &#123;</span><br><span class="line">    foo: &#123;</span><br><span class="line">      files: [</span><br><span class="line">        &#123;<span class="attr">src</span>: [<span class="string">'src/aa.js'</span>, <span class="string">'src/aaa.js'</span>], <span class="attr">dest</span>: <span class="string">'dest/a.js'</span>&#125;,</span><br><span class="line">        &#123;<span class="attr">src</span>: [<span class="string">'src/aa1.js'</span>, <span class="string">'src/aaa1.js'</span>], <span class="attr">dest</span>: <span class="string">'dest/a1.js'</span>&#125;,</span><br><span class="line">      ],</span><br><span class="line">    &#125;,</span><br><span class="line">    bar: &#123;</span><br><span class="line">      files: [</span><br><span class="line">        &#123;<span class="attr">src</span>: [<span class="string">'src/bb.js'</span>, <span class="string">'src/bbb.js'</span>], <span class="attr">dest</span>: <span class="string">'dest/b/'</span>, <span class="attr">nonull</span>: <span class="literal">true</span>&#125;,</span><br><span class="line">        &#123;<span class="attr">src</span>: [<span class="string">'src/bb1.js'</span>, <span class="string">'src/bbb1.js'</span>], <span class="attr">dest</span>: <span class="string">'dest/b1/'</span>, <span class="attr">filter</span>: <span class="string">'isFile'</span>&#125;,</span><br><span class="line">      ],</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="较老的格式"><a href="#较老的格式" class="headerlink" title="较老的格式"></a>较老的格式</h3><p><strong>dest-as-target</strong>文件格式在多任务和目标出现之前是一个过渡形式，目标文件路径实际上就是目标名称。遗憾的是, 由于目标名称是文件路径，那么运行<code>grunt task:target</code>可能不合适。此外，你也不能指定一个目标级的<code>options</code>或者给每个<code>src-dest</code>文件映射指定额外属性。</p>
<p>此种格式已经不赞成使用，请尽量不要使用。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">grunt.initConfig(&#123;</span><br><span class="line">  concat: &#123;</span><br><span class="line">    <span class="string">'dest/a.js'</span>: [<span class="string">'src/aa.js'</span>, <span class="string">'src/aaa.js'</span>],</span><br><span class="line">    <span class="string">'dest/b.js'</span>: [<span class="string">'src/bb.js'</span>, <span class="string">'src/bbb.js'</span>],</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="自定义过滤函数"><a href="#自定义过滤函数" class="headerlink" title="自定义过滤函数"></a>自定义过滤函数</h3><p><code>filter</code>属性可以给你的目标文件提供一个更高级的详细帮助信息。只需要使用一个有效的<a href="https://nodejs.org/docs/latest/api/fs.html#fs_class_fs_stats" target="_blank" rel="noopener">fs.Stats 方法名</a>。下面的配置仅仅清理一个与模式匹配的真实的文件：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">grunt.initConfig(&#123;</span><br><span class="line">  clean: &#123;</span><br><span class="line">    foo: &#123;</span><br><span class="line">      src: [<span class="string">'tmp/**/*'</span>],</span><br><span class="line">      filter: <span class="string">'isFile'</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>或者创建你自己的<code>filter</code>函数，根据文件是否匹配来返回<code>true</code>或者<code>false</code>。下面的例子将仅仅清理一个空目录：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">grunt.initConfig(&#123;</span><br><span class="line">  clean: &#123;</span><br><span class="line">    foo: &#123;</span><br><span class="line">      src: [<span class="string">'tmp/**/*'</span>],</span><br><span class="line">      filter: <span class="function"><span class="keyword">function</span>(<span class="params">filepath</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> (grunt.file.isDir(filepath) &amp;&amp; <span class="built_in">require</span>(<span class="string">'fs'</span>).readdirSync(filepath).length === <span class="number">0</span>);</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>Another example—which utilizes the <a href="https://www.gruntjs.net/configuring-tasks#globbing-patterns" target="_blank" rel="noopener">globbing</a> and <a href="https://www.gruntjs.net/configuring-tasks#building-the-files-object-dynamically" target="_blank" rel="noopener">expand: true</a> features—allows you to avoid overwriting files which already exist in the destination:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">grunt.initConfig(&#123;</span><br><span class="line">  copy: &#123;</span><br><span class="line">    templates: &#123;</span><br><span class="line">      files: [&#123;</span><br><span class="line">        expand: <span class="literal">true</span>,</span><br><span class="line">        cwd: [<span class="string">'templates/css/'</span>],     <span class="comment">// Parent folder of original CSS templates</span></span><br><span class="line">        src: <span class="string">'**/*.css'</span>,             <span class="comment">// Collects all `*.css` files within the parent folder (and its subfolders)</span></span><br><span class="line">        dest: <span class="string">'src/css/'</span>,            <span class="comment">// Stores the collected `*.css` files in your `src/css/` folder</span></span><br><span class="line">        filter: <span class="function"><span class="keyword">function</span> (<span class="params">dest</span>) </span>&#123;    <span class="comment">// `dest`, in this instance, is the filepath of each matched `src`</span></span><br><span class="line">          <span class="keyword">var</span> cwd = <span class="keyword">this</span>.cwd,        <span class="comment">// Configures variables (these are documented for your convenience only)</span></span><br><span class="line">              src = dest.replace(<span class="keyword">new</span> <span class="built_in">RegExp</span>(<span class="string">'^'</span> + cwd), <span class="string">''</span>);</span><br><span class="line">              dest = grunt.task.current.data.files[<span class="number">0</span>].dest;</span><br><span class="line">          <span class="keyword">return</span> (!grunt.file.exists(dest + src));    <span class="comment">// Copies `src` files ONLY if their destinations are unoccupied</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>Keep in mind the above technique does not account for the <a href="https://www.gruntjs.net/configuring-tasks#building-the-files-object-dynamically" target="_blank" rel="noopener">rename property</a> when checking if the destination exists.</p>
<h3 id="通配符模式"><a href="#通配符模式" class="headerlink" title="通配符模式"></a>通配符模式</h3><p>通常分别指定所有源文件路径是不切实际的，因此Grunt通过内置支持<a href="https://github.com/isaacs/node-glob" target="_blank" rel="noopener">node-glob</a> 和 <a href="https://github.com/isaacs/minimatch" target="_blank" rel="noopener">minimatch</a> 库来匹配文件名(又叫作<code>globbing</code>)。</p>
<p>然这并不是一个综合的匹配模式方面的教程，你只需要知道如何在文件路径匹配过程中使用它们即可：</p>
<ul>
<li><code>*</code> 匹配任意数量的字符，但不匹配 <code>/</code></li>
<li><code>?</code> 匹配单个字符，但不匹配 <code>/</code></li>
<li><code>**</code> 匹配任意数量的字符，包括 <code>/</code>，只要它是路径中唯一的一部分</li>
<li><code>{}</code> 允许使用一个逗号分割的“或”表达式列表</li>
<li><code>!</code> 在模式的开头用于排除一个匹配模式所匹配的任何文件</li>
</ul>
<p>每个人都需要知道的是：<code>foo/*.js</code>将匹配位于<code>foo/</code>目录下的所有的<code>.js</code>结尾的文件；而<code>foo/**/*js</code>将匹配<code>foo/</code>目录以<em>及其子目录</em>中所有以<code>.js</code>结尾的文件。</p>
<p>此外, 为了简化原本复杂的通配符模式，Grunt允许指定一个数组形式的文件路径或者一个通配符模式。所有模式按顺序处理，模式处理的过程中，带有<code>!</code>前缀的模式所匹配的文件将不包含在结果集中。 而且其结果集中的每一项也是唯一的。</p>
<p>例如：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 指定单个文件：</span></span><br><span class="line">&#123;<span class="attr">src</span>: <span class="string">'foo/this.js'</span>, <span class="attr">dest</span>: ...&#125;</span><br><span class="line"><span class="comment">// 指定一个文件数组：</span></span><br><span class="line">&#123;<span class="attr">src</span>: [<span class="string">'foo/this.js'</span>, <span class="string">'foo/that.js'</span>, <span class="string">'foo/the-other.js'</span>], <span class="attr">dest</span>: ...&#125;</span><br><span class="line"><span class="comment">// 使用一个匹配模式：</span></span><br><span class="line">&#123;<span class="attr">src</span>: <span class="string">'foo/th*.js'</span>, <span class="attr">dest</span>: ...&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 一个独立的node-glob模式：</span></span><br><span class="line">&#123;<span class="attr">src</span>: <span class="string">'foo/&#123;a,b&#125;*.js'</span>, <span class="attr">dest</span>: ...&#125;</span><br><span class="line"><span class="comment">// 也可以这样编写：</span></span><br><span class="line">&#123;<span class="attr">src</span>: [<span class="string">'foo/a*.js'</span>, <span class="string">'foo/b*.js'</span>], <span class="attr">dest</span>: ...&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// foo目录中所有的.js文件，按字母顺序排序：</span></span><br><span class="line">&#123;<span class="attr">src</span>: [<span class="string">'foo/*.js'</span>], <span class="attr">dest</span>: ...&#125;</span><br><span class="line"><span class="comment">// 首先是bar.js，接着是剩下的.js文件，并按字母顺序排序：</span></span><br><span class="line">&#123;<span class="attr">src</span>: [<span class="string">'foo/bar.js'</span>, <span class="string">'foo/*.js'</span>], <span class="attr">dest</span>: ...&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 除bar.js之外的所有的.js文件，按字母顺序排序：</span></span><br><span class="line">&#123;<span class="attr">src</span>: [<span class="string">'foo/*.js'</span>, <span class="string">'!foo/bar.js'</span>], <span class="attr">dest</span>: ...&#125;</span><br><span class="line"><span class="comment">// 按字母顺序排序的所有.js文件，但是bar.js在最后。</span></span><br><span class="line">&#123;<span class="attr">src</span>: [<span class="string">'foo/*.js'</span>, <span class="string">'!foo/bar.js'</span>, <span class="string">'foo/bar.js'</span>], <span class="attr">dest</span>: ...&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 模板也可以用于文件路径或者匹配模式中：</span></span><br><span class="line">&#123;<span class="attr">src</span>: [<span class="string">'src/&lt;%= basename %&gt;.js'</span>], <span class="attr">dest</span>: <span class="string">'build/&lt;%= basename %&gt;.min.js'</span>&#125;</span><br><span class="line"><span class="comment">// 它们也可以引用在配置中定义的其他文件列表：</span></span><br><span class="line">&#123;<span class="attr">src</span>: [<span class="string">'foo/*.js'</span>, <span class="string">'&lt;%= jshint.all.src %&gt;'</span>], <span class="attr">dest</span>: ...&#125;</span><br></pre></td></tr></table></figure>

<p>更多关于通配符模式的语法，请查看<a href="https://github.com/isaacs/node-glob" target="_blank" rel="noopener">node-glob</a> 和 <a href="https://github.com/isaacs/minimatch" target="_blank" rel="noopener">minimatch</a> 的文档。</p>
<h3 id="动态构建文件对象"><a href="#动态构建文件对象" class="headerlink" title="动态构建文件对象"></a>动态构建文件对象</h3><p>当你希望处理大量的单个文件时，这里有一些附加的属性可以用来动态的构建一个文件列表。这些属性都可以用于 <a href="https://www.gruntjs.net/configuring-tasks#compact-format" target="_blank" rel="noopener">Compact</a> 和 <a href="https://www.gruntjs.net/configuring-tasks#files-array-format" target="_blank" rel="noopener">Files Array</a> 文件映射格式。</p>
<p><code>expand</code> 设置为<code>true</code>将启用下面的选项：</p>
<ul>
<li><code>cwd</code> 所有<code>src</code>指定的匹配都将相对于此处指定的路径（但不包括此路径） 。</li>
<li><code>src</code> 相对于<code>cwd</code>路径的匹配模式。</li>
<li><code>dest</code> 目标文件路径前缀。</li>
<li><code>ext</code> 对于生成的<code>dest</code>路径中所有实际存在文件，均使用这个属性值替换扩展名。</li>
<li><code>extDot</code> 用于指定标记扩展名的英文点号的所在位置。可以赋值 <code>&#39;first&#39;</code> （扩展名从文件名中的第一个英文点号开始） 或 <code>&#39;last&#39;</code> （扩展名从最后一个英文点号开始），默认值为 <code>&#39;first&#39;</code> <em>[添加于 0.4.3 版本]</em></li>
<li><code>flatten</code> 从生成的<code>dest</code>路径中移除所有的路径部分。</li>
<li><code>rename</code> Embeds a customized function, which returns a string containing the new destination and filename. This function is called for each matched <code>src</code> file (after extension renaming and flattening). <a href="https://www.gruntjs.net/configuring-tasks#the-rename-property" target="_blank" rel="noopener">More information</a></li>
</ul>
<p>在下面的例子中，<code>uglify</code> 任务中的<code>static_mappings</code>和<code>dynamic_mappings</code>两个目标具有相同的<code>src-dest</code>文件映射列表, 这是因为任务运行时Grunt会自动展开<code>dynamic_mappings</code>文件对象为4个单独的静态<code>src-dest</code>文件映射–假设这4个文件能够找到。</p>
<p>可以指定任意静态<code>src-dest</code>和动态的<code>src-dest</code>文件映射相互结合。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">grunt.initConfig(&#123;</span><br><span class="line">  uglify: &#123;</span><br><span class="line">    static_mappings: &#123;</span><br><span class="line">      <span class="comment">// Because these src-dest file mappings are manually specified, every</span></span><br><span class="line">      <span class="comment">// time a new file is added or removed, the Gruntfile has to be updated.</span></span><br><span class="line">      files: [</span><br><span class="line">        &#123;<span class="attr">src</span>: <span class="string">'lib/a.js'</span>, <span class="attr">dest</span>: <span class="string">'build/a.min.js'</span>&#125;,</span><br><span class="line">        &#123;<span class="attr">src</span>: <span class="string">'lib/b.js'</span>, <span class="attr">dest</span>: <span class="string">'build/b.min.js'</span>&#125;,</span><br><span class="line">        &#123;<span class="attr">src</span>: <span class="string">'lib/subdir/c.js'</span>, <span class="attr">dest</span>: <span class="string">'build/subdir/c.min.js'</span>&#125;,</span><br><span class="line">        &#123;<span class="attr">src</span>: <span class="string">'lib/subdir/d.js'</span>, <span class="attr">dest</span>: <span class="string">'build/subdir/d.min.js'</span>&#125;,</span><br><span class="line">      ],</span><br><span class="line">    &#125;,</span><br><span class="line">    dynamic_mappings: &#123;</span><br><span class="line">      <span class="comment">// Grunt will search for "**/*.js" under "lib/" when the "uglify" task</span></span><br><span class="line">      <span class="comment">// runs and build the appropriate src-dest file mappings then, so you</span></span><br><span class="line">      <span class="comment">// don't need to update the Gruntfile when files are added or removed.</span></span><br><span class="line">      files: [</span><br><span class="line">        &#123;</span><br><span class="line">          expand: <span class="literal">true</span>,     <span class="comment">// Enable dynamic expansion.</span></span><br><span class="line">          cwd: <span class="string">'lib/'</span>,      <span class="comment">// Src matches are relative to this path.</span></span><br><span class="line">          src: [<span class="string">'**/*.js'</span>], <span class="comment">// Actual pattern(s) to match.</span></span><br><span class="line">          dest: <span class="string">'build/'</span>,   <span class="comment">// Destination path prefix.</span></span><br><span class="line">          ext: <span class="string">'.min.js'</span>,   <span class="comment">// Dest filepaths will have this extension.</span></span><br><span class="line">          extDot: <span class="string">'first'</span>   <span class="comment">// Extensions in filenames begin after the first dot</span></span><br><span class="line">        &#125;,</span><br><span class="line">      ],</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h4 id="The-rename-Property"><a href="#The-rename-Property" class="headerlink" title="The rename Property"></a>The rename Property</h4><p>The <code>rename</code> property is unique, as the only valid value for it is a JavaScript function. Although the function returns a string, you cannot simply use a string as a value for <code>rename</code> (doing so results in an error: <code>Property &#39;rename&#39; of object # is not a function</code>). In the following example, the <code>copy</code> task will create a backup of README.md.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">grunt.initConfig(&#123;</span><br><span class="line">  copy: &#123;</span><br><span class="line">    backup: &#123;</span><br><span class="line">      files: [&#123;</span><br><span class="line">        expand: <span class="literal">true</span>,</span><br><span class="line">        src: [<span class="string">'docs/README.md'</span>],    <span class="comment">// The README.md file has been specified for backup</span></span><br><span class="line">        rename: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;       <span class="comment">// The value for rename must be a function</span></span><br><span class="line">          <span class="keyword">return</span> <span class="string">'docs/BACKUP.txt'</span>; <span class="comment">// The function must return a string with the complete destination</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>When the function is called, the <code>dest</code> and matched <code>src</code> path are passed in and can be used for returning the output string. In the following example, files are copied from the <code>dev</code> folder to the <code>dist</code> folder, and renamed to have the word “beta” removed .</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">grunt.initConfig(&#123;</span><br><span class="line">  copy: &#123;</span><br><span class="line">    production: &#123;</span><br><span class="line">      files: [&#123;</span><br><span class="line">        expand: <span class="literal">true</span>,</span><br><span class="line">        cwd: <span class="string">'dev/'</span>,</span><br><span class="line">        src: [<span class="string">'*'</span>],</span><br><span class="line">        dest: <span class="string">'dist/'</span>,</span><br><span class="line">        rename: <span class="function"><span class="keyword">function</span> (<span class="params">dest, src</span>) </span>&#123;          <span class="comment">// The `dest` and `src` values can be passed into the function</span></span><br><span class="line">          <span class="keyword">return</span> dest + src.replace(<span class="string">'beta'</span>,<span class="string">''</span>); <span class="comment">// The `src` is being renamed; the `dest` remains the same</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>If multiple matched <code>src</code> paths are renamed to an identical destination (i.e. if two different files get renamed to the same file), each output will be added to an array of sources for it.</p>
<h2 id="模板"><a href="#模板" class="headerlink" title="模板"></a>模板</h2><p>使用<code>&lt;% %&gt;</code>分隔符指定的模板会在任务从它们的配置中读取相应的数据时将自动扩展扫描。模板会被递归的展开，直到配置中不再存在遗留的模板相关的信息(与模板匹配的)。</p>
<p>整个配置对象决定了属性上下文(模板中的属性)。此外，在模板中使用<code>grunt</code>以及它的方法都是有效的，例如： <code>&lt;%= grunt.template.today(&#39;yyyy-mm-dd&#39;) %&gt;</code>。</p>
<ul>
<li><code>&lt;%= prop.subprop %&gt;</code> 将会自动展开配置信息中的<code>prop.subprop</code>的值，不管是什么类型。像这样的模板不仅可以用来引用字符串值，还可以引用数组或者其他对象类型的值。</li>
<li><code>&lt;% %&gt;</code> 执行任意内联的JavaScript代码。对于控制流或者循环来说是非常有用的。</li>
</ul>
<p>下面以<code>concat</code>任务配置为例，运行<code>grunt concat:sample</code>时将通过banner中的<code>/* abcde */</code>连同<code>foo/*.js</code>+<code>bar/*.js</code>+<code>bar/*.js</code>匹配的所有文件来生成一个名为<code>build/abcde.js</code>的文件。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">grunt.initConfig(&#123;</span><br><span class="line">  concat: &#123;</span><br><span class="line">    sample: &#123;</span><br><span class="line">      options: &#123;</span><br><span class="line">        banner: <span class="string">'/* &lt;%= baz %&gt; */\n'</span>,   <span class="comment">// '/* abcde */\n'</span></span><br><span class="line">      &#125;,</span><br><span class="line">      src: [<span class="string">'&lt;%= qux %&gt;'</span>, <span class="string">'baz/*.js'</span>],  <span class="comment">// [['foo/*.js', 'bar/*.js'], 'baz/*.js']</span></span><br><span class="line">      dest: <span class="string">'build/&lt;%= baz %&gt;.js'</span>,      <span class="comment">// 'build/abcde.js'</span></span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">//用于任务配置模板的任意属性</span></span><br><span class="line">  foo: <span class="string">'c'</span>,</span><br><span class="line">  bar: <span class="string">'b&lt;%= foo %&gt;d'</span>, <span class="comment">// 'bcd'</span></span><br><span class="line">  baz: <span class="string">'a&lt;%= bar %&gt;e'</span>, <span class="comment">// 'abcde'</span></span><br><span class="line">  qux: [<span class="string">'foo/*.js'</span>, <span class="string">'bar/*.js'</span>],</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="导入外部数据"><a href="#导入外部数据" class="headerlink" title="导入外部数据"></a>导入外部数据</h2><p>在下面的Gruntfile中，项目的元数据是从<code>package.json</code>文件中导入到Grunt配置中的，并且<a href="https://github.com/gruntjs/grunt-contrib-uglify" target="_blank" rel="noopener">grunt-contrib-uglify 插件</a>中的 <code>uglify</code> 任务被配置用于压缩一个源文件以及使用该元数据动态的生成一个banner注释。</p>
<p>Grunt有<code>grunt.file.readJSON</code>和<code>grunt.file.readYAML</code>两个方法分别用于引入JSON和YAML数据。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">grunt.initConfig(&#123;</span><br><span class="line">  pkg: grunt.file.readJSON(<span class="string">'package.json'</span>),</span><br><span class="line">  uglify: &#123;</span><br><span class="line">    options: &#123;</span><br><span class="line">      banner: <span class="string">'/*! &lt;%= pkg.name %&gt; &lt;%= grunt.template.today("yyyy-mm-dd") %&gt; */\n'</span></span><br><span class="line">    &#125;,</span><br><span class="line">    dist: &#123;</span><br><span class="line">      src: <span class="string">'src/&lt;%= pkg.name %&gt;.js'</span>,</span><br><span class="line">      dest: <span class="string">'dist/&lt;%= pkg.name %&gt;.min.js'</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h1 id="Gruntfile-实例"><a href="#Gruntfile-实例" class="headerlink" title="Gruntfile 实例"></a>Gruntfile 实例</h1><p>In this page we walk you through the creation of a <code>Gruntfile</code> that covers the usual needs of a simple project. If you already know how to set up a <code>Gruntfile</code> and you’re looking for a quick example, here’s one:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = <span class="function"><span class="keyword">function</span>(<span class="params">grunt</span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">  grunt.initConfig(&#123;</span><br><span class="line">    jshint: &#123;</span><br><span class="line">      files: [<span class="string">'Gruntfile.js'</span>, <span class="string">'src/**/*.js'</span>, <span class="string">'test/**/*.js'</span>],</span><br><span class="line">      options: &#123;</span><br><span class="line">        globals: &#123;</span><br><span class="line">          jQuery: <span class="literal">true</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    watch: &#123;</span><br><span class="line">      files: [<span class="string">'&lt;%= jshint.files %&gt;'</span>],</span><br><span class="line">      tasks: [<span class="string">'jshint'</span>]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  grunt.loadNpmTasks(<span class="string">'grunt-contrib-jshint'</span>);</span><br><span class="line">  grunt.loadNpmTasks(<span class="string">'grunt-contrib-watch'</span>);</span><br><span class="line"></span><br><span class="line">  grunt.registerTask(<span class="string">'default'</span>, [<span class="string">'jshint'</span>]);</span><br><span class="line"></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="Requirements"><a href="#Requirements" class="headerlink" title="Requirements"></a>Requirements</h2><p>Every project has its own needs, but most of them have something in common. In this guide we introduce you to a few Grunt plugins to automate basic requirements. The final goal is to teach you how to configure these Grunt plugins so that you can use them in your projects.</p>
<p>For the sake of the example, let’s say that you’re creating a JavaScript library. The typical folder structure features the following folders: <code>src</code>, <code>dist</code>, and <code>test</code>. The <code>src</code> folder (sometimes called <code>app</code>) contains the source code of the library as you author it. The <code>dist</code> folder (sometimes called <code>build</code>) contains the distribution, a minified version of the source code. A minified file is one where all unnecessary characters, such as spaces, new lines, comments are removed, without affecting the functionality of the source code. Minified source code is especially useful for users of the project because it reduces the amount of data that needs to be transferred. Finally, the <code>test</code> folder contains the code to test the project. This set up will be used in the next sections when creating the <code>Gruntfile</code> configuration.</p>
<p>While developing the library and releasing new versions there are a few tasks that you need to perform on a regular basis. For example, you might want to ensure that the code you write adheres to best practices, or that the code you’ve written doesn’t result in unexpected behaviors. To do that, you can employ a tool called <a href="http://jshint.com/about/" target="_blank" rel="noopener">JSHint</a>. Grunt has an official plugin for it called <a href="https://github.com/gruntjs/grunt-contrib-jshint" target="_blank" rel="noopener">grunt-contrib-jshint</a> which we’ll adopt in this example. In particular, you might want to ensure that as you modify your code, you don’t break any rules or best practices. So, a good strategy is to check the code at every change you perform. To do that, we’ll cover a Grunt plugin called <a href="https://github.com/gruntjs/grunt-contrib-watch" target="_blank" rel="noopener">grunt-contrib-watch</a>. The latter runs predefined tasks, such as <code>grunt-contrib-jshint</code>, whenever files are added, changed, or deleted.</p>
<p>Checking that your source code follows best practices is not enough to guarantee that it’s stable and doesn’t contain bugs. To create a robust project, you need to test it. There are several libraries you can adopt such as <a href="https://qunitjs.com/" target="_blank" rel="noopener">QUnit</a> or <a href="http://jasmine.github.io/" target="_blank" rel="noopener">Jasmine</a>. In this guide, we describe how to configure QUnit, and specifically <a href="https://github.com/gruntjs/grunt-contrib-qunit" target="_blank" rel="noopener">grunt-contrib-qunit</a>, to test your code.</p>
<p>When it comes to distributing your work, you want to offer a version as small in size as possible. To create a minified version you need a Grunt plugin like <a href="https://github.com/gruntjs/grunt-contrib-uglify" target="_blank" rel="noopener">grunt-contrib-uglify</a>. Moreover, unless the project you’re developing is very small, chances are that you’ve split the code in multiple files. While this is a good practice for the developer, you want users to include only one file. So, before minifying the code, you should concatenate the source files to create a single one. To achieve this goal you need a Grunt plugin like <a href="https://github.com/gruntjs/grunt-contrib-concat" target="_blank" rel="noopener">grunt-contrib-concat</a>.</p>
<p>To sum up, in this guide we’ll use the following five Grunt plugins:</p>
<ul>
<li><a href="https://github.com/gruntjs/grunt-contrib-uglify" target="_blank" rel="noopener">grunt-contrib-uglify</a></li>
<li><a href="https://github.com/gruntjs/grunt-contrib-qunit" target="_blank" rel="noopener">grunt-contrib-qunit</a></li>
<li><a href="https://github.com/gruntjs/grunt-contrib-concat" target="_blank" rel="noopener">grunt-contrib-concat</a></li>
<li><a href="https://github.com/gruntjs/grunt-contrib-jshint" target="_blank" rel="noopener">grunt-contrib-jshint</a></li>
<li><a href="https://github.com/gruntjs/grunt-contrib-watch" target="_blank" rel="noopener">grunt-contrib-watch</a></li>
</ul>
<p>If you’re curious about what the final result looks like, the entire <code>Gruntfile</code> can be found at the bottom of this page.</p>
<h2 id="Setting-up-the-Gruntfile"><a href="#Setting-up-the-Gruntfile" class="headerlink" title="Setting up the Gruntfile"></a>Setting up the <code>Gruntfile</code></h2><p>The first part is the “wrapper” function, which encapsulates your Grunt configuration.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = <span class="function"><span class="keyword">function</span>(<span class="params">grunt</span>) </span>&#123;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>Within that function we can initialize our configuration object:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">grunt.initConfig(&#123;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>Next, we can store the project settings from the <code>package.json</code> file into the <code>pkg</code> property. This allows us to refer to the values of properties within our <code>package.json</code> file, as we’ll see shortly.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pkg: grunt.file.readJSON(<span class="string">'package.json'</span>)</span><br></pre></td></tr></table></figure>

<p>This leaves us with this so far:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = <span class="function"><span class="keyword">function</span>(<span class="params">grunt</span>) </span>&#123;</span><br><span class="line">  grunt.initConfig(&#123;</span><br><span class="line">    pkg: grunt.file.readJSON(<span class="string">'package.json'</span>)</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>Now we can define a configuration for each of the tasks we mentioned. The configuration object for a plugin lives as a property on the configuration object, that often shares the same name as its plugin. The configuration for <code>grunt-contrib-concat</code> goes in the configuration object under the <code>concat</code> key as shown below:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">concat: &#123;</span><br><span class="line">  options: &#123;</span><br><span class="line">    <span class="comment">// define a string to put between each file in the concatenated output</span></span><br><span class="line">    separator: <span class="string">';'</span></span><br><span class="line">  &#125;,</span><br><span class="line">  dist: &#123;</span><br><span class="line">    <span class="comment">// the files to concatenate</span></span><br><span class="line">    src: [<span class="string">'src/**/*.js'</span>],</span><br><span class="line">    <span class="comment">// the location of the resulting JS file</span></span><br><span class="line">    dest: <span class="string">'dist/&lt;%= pkg.name %&gt;.js'</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Note how in the snippet above we refer to the <code>name</code> property that’s in the JSON file. We access it by using <code>pkg.name</code> as earlier we defined the <code>pkg</code> property to be the result of loading the <code>package.json</code> file, which is then parsed to a JavaScript object. Grunt has a simple template engine to output the values of properties in the configuration object. Here we tell the <code>concat</code> task to concatenate all files that exist within <code>src/</code> and end in <code>.js</code>.</p>
<p>Now let’s configure the <code>grunt-contrib-uglify</code> plugin, which minifies the JavaScript code:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">uglify: &#123;</span><br><span class="line">  options: &#123;</span><br><span class="line">    <span class="comment">// the banner is inserted at the top of the output</span></span><br><span class="line">    banner: <span class="string">'/*! &lt;%= pkg.name %&gt; &lt;%= grunt.template.today("dd-mm-yyyy") %&gt; */\n'</span></span><br><span class="line">  &#125;,</span><br><span class="line">  dist: &#123;</span><br><span class="line">    files: &#123;</span><br><span class="line">      <span class="string">'dist/&lt;%= pkg.name %&gt;.min.js'</span>: [<span class="string">'&lt;%= concat.dist.dest %&gt;'</span>]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>This snippet tells <code>grunt-contrib-uglify</code> to create a file within <code>dist/</code> that contains the result of minifying the JavaScript files. Here we use <code>&lt;%= concat.dist.dest %&gt;</code> so uglify will minify the file that the concat task produces.</p>
<p>Up to this point, we have configured the plugins to create the distribution version the library. It’s now time to use <code>grunt-contrib-qunit</code> to automate the testing of the code. To do that, we need to give to specify the location of the test runner files, which are the HTML files QUnit runs on. The resulting code is reported below:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">qunit: &#123;</span><br><span class="line">  files: [<span class="string">'test/**/*.html'</span>]</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<p>Once done, it’s time to set up the configuration to ensure that the code of the project adheres to best practices. JSHint is a tool that can detect issues or potential issues like a high cyclomatic complexity, the use of the equality operator instead of the strict equality operator, and the definition of unused variables and functions.</p>
<p>We advise you to analyze with <code>grunt-contrib-jshint</code> all the JavaScript files of your project, including <code>Gruntfile</code> and the test files. An example of configuration of <code>grunt-contrib-jshint</code> is the following:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">jshint: &#123;</span><br><span class="line">  <span class="comment">// define the files to lint</span></span><br><span class="line">  files: [<span class="string">'Gruntfile.js'</span>, <span class="string">'src/**/*.js'</span>, <span class="string">'test/**/*.js'</span>],</span><br><span class="line">  <span class="comment">// configure JSHint (documented at http://www.jshint.com/docs/)</span></span><br><span class="line">  options: &#123;</span><br><span class="line">    <span class="comment">// more options here if you want to override JSHint defaults</span></span><br><span class="line">    globals: &#123;</span><br><span class="line">      jQuery: <span class="literal">true</span>,</span><br><span class="line">      <span class="built_in">console</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="built_in">module</span>: <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>This plugin takes an array of files and then an object of options. These are all <a href="http://www.jshint.com/docs/" target="_blank" rel="noopener">documented on the JSHint site</a>. If you’re happy with the plugin defaults, there’s no need to redefine them in the Gruntfile.</p>
<p>The last plugin left to configure is <code>grunt-contrib-watch</code>. We’ll use it to run the <code>jshint</code> and the <code>qunit</code> tasks as soon as a JavaScript file is added, deleted, or modified. When it detects any of the files specified have changed (here, we use the same files we told JSHint to check), it will run the tasks you specify, in the order they appear. This can be run on the command line with <code>grunt watch</code>.</p>
<p>Turning the previous description into a configuration for <code>grunt-contrib-watch</code> results in the snippet below:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">watch: &#123;</span><br><span class="line">  files: [<span class="string">'&lt;%= jshint.files %&gt;'</span>],</span><br><span class="line">  tasks: [<span class="string">'jshint'</span>, <span class="string">'qunit'</span>]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="创建任务"><a href="#创建任务" class="headerlink" title="创建任务"></a>创建任务</h1><p>任务是Grunt的面包和奶油。就像你常用的工具，如： <code>jshint</code> 或 <code>nodeunit</code>。每当运行Grunt时, 你可以为其指定一个或多个任务, 这些任务用于告诉Grunt你想要它做什么事情。</p>
<p>如果你没有指定一个任务，并且你已经定义一个名为 “default” 的任务，那么该任务将会默认被执行（不用诧异，总要做点儿什么啊！）。</p>
<h2 id="任务别名"><a href="#任务别名" class="headerlink" title="任务别名"></a>任务别名</h2><p>如果指定了一个任务列表，新任务将是这一个或多个指定任务的别名。当运行此 “任务别名” 时，在 <code>taskList</code> 中指定的每个任务都会按照其出现的顺序依次执行。<code>taskList</code>参数必须时一个任务数组。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">grunt.registerTask(taskName, [description, ] taskList)</span><br></pre></td></tr></table></figure>

<p>下面的任务别名案例中定义了一个 ‘default’ 任务，如果运行Grunt时没有指定任何任务，它将自动执行’jshint’、’qunit’、’concat’ 和 ‘uglify’ 任务。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">grunt.registerTask(<span class="string">'default'</span>, [<span class="string">'jshint'</span>, <span class="string">'qunit'</span>, <span class="string">'concat'</span>, <span class="string">'uglify'</span>]);</span><br></pre></td></tr></table></figure>

<p>还可以给任务指定参数。在下面的案例中，别名 “dist” 将执行 “concat” 和 “uglify” 两个任务，并且它们都带有一个 “dist” 参数：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">grunt.registerTask(<span class="string">'dist'</span>, [<span class="string">'concat:dist'</span>, <span class="string">'uglify:dist'</span>]);</span><br></pre></td></tr></table></figure>

<h2 id="多任务"><a href="#多任务" class="headerlink" title="多任务"></a>多任务</h2><p>当运行一个多任务时，Grunt会自动从项目的配置对象中查找同名属性。多任务可以有多个配置，并且可以使用任意命名的’targets’。</p>
<p>同时指定像<code>grunt concat:foo</code>或者<code>grunt concat:bar</code>这样的任务和目标，在运行时Grunt只会处理指定目标的配置；然而如果运行<code>grunt concat</code>，将会遍历所有的目标, 并按任务指定的顺序处理每个目标。注意，如果一个任务已经使用<a href="https://www.gruntjs.net/grunt.task#grunt.task.renametask" target="_blank" rel="noopener">grunt.task.renameTask</a>重命名过，Grunt将会自动在配置对象中查找新任务名称属性。</p>
<p>大部分的contrib任务(主要是指官方提供的任务)，包括<a href="https://github.com/gruntjs/grunt-contrib-jshint#jshint-task" target="_blank" rel="noopener">grunt-contrib-jshint插件的jshint任务</a>，以及<a href="https://github.com/gruntjs/grunt-contrib-concat#concat-task" target="_blank" rel="noopener">grunt-contrib-concat插件的concat任务</a>都是多任务形式的。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">grunt.registerMultiTask(taskName, [description, ] taskFunction)</span><br></pre></td></tr></table></figure>

<p>对于指定的配置，这里有一个案例演示了如果通过<code>grunt log:foo</code>运行Grunt，它会输出<code>foo: 1,2,3</code>；如果通过<code>grunt log:bar</code>来运行Grunt， 它会输出<code>bar: hello world</code>。然而如果通过<code>grunt log</code>运行Grunt, 它会输出<code>foo: 1,2,3</code>，然后是<code>bar: hello world</code>，最后是<code>baz: false</code>(任务目标会按照指定的顺序进行处理)。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">grunt.initConfig(&#123;</span><br><span class="line">  log: &#123;</span><br><span class="line">    foo: [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>],</span><br><span class="line">    bar: <span class="string">'hello world'</span>,</span><br><span class="line">    baz: <span class="literal">false</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">grunt.registerMultiTask(<span class="string">'log'</span>, <span class="string">'Log stuff.'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  grunt.log.writeln(<span class="keyword">this</span>.target + <span class="string">': '</span> + <span class="keyword">this</span>.data);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="“基本”-任务"><a href="#“基本”-任务" class="headerlink" title="“基本” 任务"></a>“基本” 任务</h2><p>当一个基本任务执行时，Grunt并不会检查配置和环境 – 它仅仅执行指定的任务函数，并传递任何使用冒号分割的参数作为函数的参数。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">grunt.registerTask(taskName, [description, ] taskFunction)</span><br></pre></td></tr></table></figure>

<p>下面的案例中，如果执行 <code>grunt foo:testing:123</code>，将输出日志 <code>foo, testing 123</code>。 如果执行这个任务时不传递参数，只是执行 <code>grunt foo</code>，那么将输出日志 <code>foo, no args</code>。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">grunt.registerTask(<span class="string">'foo'</span>, <span class="string">'A sample task that logs stuff.'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">arg1, arg2</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="built_in">arguments</span>.length === <span class="number">0</span>) &#123;</span><br><span class="line">    grunt.log.writeln(<span class="keyword">this</span>.name + <span class="string">", no args"</span>);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    grunt.log.writeln(<span class="keyword">this</span>.name + <span class="string">", "</span> + arg1 + <span class="string">" "</span> + arg2);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="自定义任务-1"><a href="#自定义任务-1" class="headerlink" title="自定义任务"></a>自定义任务</h2><p>你可以和任务一起疯狂。如果你的任务并没有遵循 “多任务” 结构，那就使用自定义任务。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">grunt.registerTask(<span class="string">'default'</span>, <span class="string">'My "default" task description.'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  grunt.log.writeln(<span class="string">'Currently running the "default" task.'</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>在一个任务内部，你可以执行其他的任务。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">grunt.registerTask(<span class="string">'foo'</span>, <span class="string">'My "foo" task.'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="comment">// Enqueue "bar" and "baz" tasks, to run after "foo" finishes, in-order.</span></span><br><span class="line">  grunt.task.run(<span class="string">'bar'</span>, <span class="string">'baz'</span>);</span><br><span class="line">  <span class="comment">// Or:</span></span><br><span class="line">  grunt.task.run([<span class="string">'bar'</span>, <span class="string">'baz'</span>]);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>任务也可以是异步的。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">grunt.registerTask(<span class="string">'asyncfoo'</span>, <span class="string">'My "asyncfoo" task.'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="comment">// Force task into async mode and grab a handle to the "done" function.</span></span><br><span class="line">  <span class="keyword">var</span> done = <span class="keyword">this</span>.async();</span><br><span class="line">  <span class="comment">// Run some sync stuff.</span></span><br><span class="line">  grunt.log.writeln(<span class="string">'Processing task...'</span>);</span><br><span class="line">  <span class="comment">// And some async stuff.</span></span><br><span class="line">  setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    grunt.log.writeln(<span class="string">'All done!'</span>);</span><br><span class="line">    done();</span><br><span class="line">  &#125;, <span class="number">1000</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>任务也可以访问它们自身名称和参数。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">grunt.registerTask(<span class="string">'foo'</span>, <span class="string">'My "foo" task.'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">a, b</span>) </span>&#123;</span><br><span class="line">  grunt.log.writeln(<span class="keyword">this</span>.name, a, b);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 用法：</span></span><br><span class="line"><span class="comment">// grunt foo</span></span><br><span class="line"><span class="comment">//   logs: "foo", undefined, undefined</span></span><br><span class="line"><span class="comment">// grunt foo:bar</span></span><br><span class="line"><span class="comment">//   logs: "foo", "bar", undefined</span></span><br><span class="line"><span class="comment">// grunt foo:bar:baz</span></span><br><span class="line"><span class="comment">//   logs: "foo", "bar", "baz"</span></span><br></pre></td></tr></table></figure>

<p>如果记录到任何错误，那么任务就会失败。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">grunt.registerTask(<span class="string">'foo'</span>, <span class="string">'My "foo" task.'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (failureOfSomeKind) &#123;</span><br><span class="line">    grunt.log.error(<span class="string">'This is an error message.'</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 如果这个任务出现错误则返回false</span></span><br><span class="line">  <span class="keyword">if</span> (ifErrors) &#123; <span class="keyword">return</span> <span class="literal">false</span>; &#125;</span><br><span class="line"></span><br><span class="line">  grunt.log.writeln(<span class="string">'This is the success message'</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>当任务失败时，所有后续任务都将终止，除非指定 <code>--force</code> 。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">grunt.registerTask(<span class="string">'foo'</span>, <span class="string">'My "foo" task.'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="comment">// Fail synchronously.</span></span><br><span class="line">  <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">grunt.registerTask(<span class="string">'bar'</span>, <span class="string">'My "bar" task.'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> done = <span class="keyword">this</span>.async();</span><br><span class="line">  setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">// Fail asynchronously.</span></span><br><span class="line">    done(<span class="literal">false</span>);</span><br><span class="line">  &#125;, <span class="number">1000</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>任务还可以依赖于其他任务的成功执行。注意 <code>grunt.task.requires</code> 并不会真正的运行其他任务，它仅仅检查其它任务是否已经执行，并且没有失败。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">grunt.registerTask(<span class="string">'foo'</span>, <span class="string">'My "foo" task.'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">grunt.registerTask(<span class="string">'bar'</span>, <span class="string">'My "bar" task.'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="comment">// 如果"foo"任务运行失败或者没有运行则任务失败。</span></span><br><span class="line">  grunt.task.requires(<span class="string">'foo'</span>);</span><br><span class="line">  <span class="comment">// 如果"foo"任务运行成功则执行这里的代码。</span></span><br><span class="line">  grunt.log.writeln(<span class="string">'Hello, world.'</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 用法：</span></span><br><span class="line"><span class="comment">// grunt foo bar</span></span><br><span class="line"><span class="comment">//   没有输出，因为"foo"失败。</span></span><br><span class="line"><span class="comment">//   ***Note: This is an example of space-separated sequential commands,</span></span><br><span class="line"><span class="comment">//   (similar to executing two lines of code: `grunt foo` then `grunt bar`)</span></span><br><span class="line"><span class="comment">// grunt bar</span></span><br><span class="line"><span class="comment">//   没有输出，因为"foo"从未运行。</span></span><br></pre></td></tr></table></figure>

<p>如果任务需要的配置属性不存在，其也可能失败。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">grunt.registerTask(<span class="string">'foo'</span>, <span class="string">'My "foo" task.'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="comment">// Fail task if "meta.name" config prop is missing</span></span><br><span class="line">  <span class="comment">// Format 1: String</span></span><br><span class="line">  grunt.config.requires(<span class="string">'meta.name'</span>);</span><br><span class="line">  <span class="comment">// or Format 2: Array</span></span><br><span class="line">  grunt.config.requires([<span class="string">'meta'</span>, <span class="string">'name'</span>]);</span><br><span class="line">  <span class="comment">// Log... conditionally.</span></span><br><span class="line">  grunt.log.writeln(<span class="string">'This will only log if meta.name is defined in the config.'</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>任务还可以访问配置属性。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">grunt.registerTask(<span class="string">'foo'</span>, <span class="string">'My "foo" task.'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="comment">// 记录属性值，如果属性未定义（undefined）则返回null。</span></span><br><span class="line">  grunt.log.writeln(<span class="string">'The meta.name property is: '</span> + grunt.config(<span class="string">'meta.name'</span>));</span><br><span class="line">  <span class="comment">// 同样的记录属性值，如果属性未定义（undefined）则返回null。</span></span><br><span class="line">  grunt.log.writeln(<span class="string">'The meta.name property is: '</span> + grunt.config([<span class="string">'meta'</span>, <span class="string">'name'</span>]));</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>在 <a href="https://github.com/gruntjs/" target="_blank" rel="noopener">contrib tasks</a> 中可以查看更多案例。</p>
<h2 id="CLI-参数-环境"><a href="#CLI-参数-环境" class="headerlink" title="CLI 参数 / 环境"></a>CLI 参数 / 环境</h2><p>通过 <code>process.env</code> 来访问<a href="https://en.wikipedia.org/wiki/Environment_variable" target="_blank" rel="noopener">环境变量</a>。</p>
<p>请参考 <a href="https://gruntjs.net/using-the-cli" target="_blank" rel="noopener">使用命令行工具</a>章节，查看完整的的命令行选项列表。</p>
<h2 id="为什么我的异步task没有完成？"><a href="#为什么我的异步task没有完成？" class="headerlink" title="为什么我的异步task没有完成？"></a>为什么我的异步task没有完成？</h2><p>Chances are this is happening because you have forgotten to call the <a href="https://gruntjs.net/api/inside-tasks#this.async" target="_blank" rel="noopener">this.async</a> method to tell Grunt that your task is asynchronous. For simplicity’s sake, Grunt uses a synchronous coding style, which can be switched to asynchronous by calling <code>this.async()</code> within the task body.</p>
<p>注意，传递 <code>false</code> 给 <code>done()</code> 函数就会告诉Grunt你的任务已经失败。</p>
<p>例如：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">grunt.registerTask(<span class="string">'asyncme'</span>, <span class="string">'My asynchronous task.'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> done = <span class="keyword">this</span>.async();</span><br><span class="line">  doSomethingAsync(done);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h1 id="创建插件"><a href="#创建插件" class="headerlink" title="创建插件"></a>创建插件</h1><ol>
<li>通过 <code>npm install -g grunt-init</code> 命令安装 <a href="https://github.com/gruntjs/grunt-init" target="_blank" rel="noopener">grunt-init</a> 。</li>
<li>通过 <code>git clone git://github.com/gruntjs/grunt-init-gruntplugin.git ~/.grunt-init/gruntplugin</code> 命令安装grunt插件模版。</li>
<li>在一个空的目录中执行 <code>grunt-init gruntplugin</code> 。</li>
<li>执行 <code>npm install</code> 命令以准备开发环境。</li>
<li>为你的插件书写代码。</li>
<li>执行 <code>npm publish</code> 命令将你创建的 Grunt 插件提发布npm！</li>
</ol>
<h2 id="注意"><a href="#注意" class="headerlink" title="注意"></a>注意</h2><h3 id="命名你的task"><a href="#命名你的task" class="headerlink" title="命名你的task"></a>命名你的task</h3><p>“grunt-contrib” 命名空间保留给 Grunt 团队维护的task使用，请给你自己的task起一个合适名字，并且避免使用被保留的命名空间。</p>
<h3 id="调试"><a href="#调试" class="headerlink" title="调试"></a>调试</h3><p>Grunt默认隐藏了error stack traces，但是可以通过 <code>--stack</code> 参数启用，方便你调试自己的task。如果你希望 Grunt 在出现错误时总是能记录下stack trace，可以在你的shell中创建一个命令别名（alias）。例如，在bash中，可以通过 <code>alias grunt=&#39;grunt --stack&#39;</code> 命令创建一个别名。</p>
<h3 id="存储任务文件"><a href="#存储任务文件" class="headerlink" title="存储任务文件"></a>存储任务文件</h3><p>只在项目根目录中的 .grunt/[npm-module-name] 目录中存储数据文件，并在适当的时候将其清除。对于临时文件这并不是一个好的解决方案, 建议使用后面列出的几个常用npm模块（例如 <a href="https://www.npmjs.org/package/temporary" target="_blank" rel="noopener">temporary</a>、<a href="https://www.npmjs.org/package/tmp" target="_blank" rel="noopener">tmp</a>）来调用操作系统级别的临时目录功能。</p>
<h3 id="避免改变当前工作目录：process-cwd"><a href="#避免改变当前工作目录：process-cwd" class="headerlink" title="避免改变当前工作目录：process.cwd()"></a>避免改变当前工作目录：<code>process.cwd()</code></h3><p>默认情况下，包含gruntfile文件的目录被设置为当前工作目录。用户可以在自己的gruntfile中通过执行<code>grunt.file.setBase()</code> 改变改变当前工作目录，但是插件不应该改变它。</p>
<p><code>path.resolve(&#39;foo&#39;)</code> 可以被用来获取’foo’ 相对于 <code>Gruntfile</code> 所在目录的绝对路径。</p>
<h3 id="Creating-your-task"><a href="#Creating-your-task" class="headerlink" title="Creating your task"></a>Creating your task</h3><p>You might also want to know how to <a href="https://gruntjs.net/creating-tasks" target="_blank" rel="noopener">create your own tasks</a> or take a look at the <a href="https://gruntjs.net/api" target="_blank" rel="noopener">API</a> reference.</p>
<h1 id="使用命令行工具"><a href="#使用命令行工具" class="headerlink" title="使用命令行工具"></a>使用命令行工具</h1><h2 id="安装命令行工具"><a href="#安装命令行工具" class="headerlink" title="安装命令行工具"></a>安装命令行工具</h2><p>执行 <code>sudo npm install -g grunt-cli</code> （Windows 用户应省略 “sudo”，并且可能需要提升权限以运行此命令）。</p>
<p><code>grunt</code>命令行接口提供了一系列选项。你可以在你的终端中使用<code>grunt -h</code>查看这个选项。</p>
<h3 id="–help-h"><a href="#–help-h" class="headerlink" title="–help, -h"></a>–help, -h</h3><p>显示帮助信息</p>
<h3 id="–base-b"><a href="#–base-b" class="headerlink" title="–base, -b"></a>–base, -b</h3><p>指定一个根路径。默认情况下，所有文件路径都是相对于 <code>Gruntfile</code> 的。</p>
<p>还可以调用 <code>grunt.file.setBase(...)</code></p>
<h3 id="–no-color"><a href="#–no-color" class="headerlink" title="–no-color"></a>–no-color</h3><p>禁用彩色输出。</p>
<h3 id="–gruntfile"><a href="#–gruntfile" class="headerlink" title="–gruntfile"></a>–gruntfile</h3><p>指定一个 <code>Gruntfile</code>。</p>
<p>默认情况下，grunt 会从当前目录或者父目录中寻找最近的 <code>Gruntfile.js</code> 或 <code>Gruntfile.[ext]</code> 文件。</p>
<h3 id="–debug-d"><a href="#–debug-d" class="headerlink" title="–debug, -d"></a>–debug, -d</h3><p>对支持调试的任务启用调试模式。</p>
<h3 id="–stack"><a href="#–stack" class="headerlink" title="–stack"></a>–stack</h3><p>因警告或者致命错误退出时打印堆栈跟踪信息。</p>
<h3 id="–force-f"><a href="#–force-f" class="headerlink" title="–force, -f"></a>–force, -f</h3><p>一种强制跳过警告信息的方式。</p>
<p>如果像从警告中得到提示，就不要使用这个选项，可以根据提示信息修正代码。</p>
<h3 id="–tasks"><a href="#–tasks" class="headerlink" title="–tasks"></a>–tasks</h3><p>指定一个包含可加载的任务和“额外”文件的目录。</p>
<p>还可以调用 <code>grunt.loadTasks(...)</code></p>
<h3 id="–npm"><a href="#–npm" class="headerlink" title="–npm"></a>–npm</h3><p>在通过 npm 安装的插件中检查可加载的任何任务以及“额外”文件。</p>
<p>还可以调用 <code>grunt.loadNpmTasks(...)</code></p>
<h3 id="–no-write"><a href="#–no-write" class="headerlink" title="–no-write"></a>–no-write</h3><p>禁用写文件操作（用于空运行）。</p>
<h3 id="–verbose-v"><a href="#–verbose-v" class="headerlink" title="–verbose, -v"></a>–verbose, -v</h3><p>冗长模式（Verbose mode）。会输出很多的信息。</p>
<h3 id="–version-V"><a href="#–version-V" class="headerlink" title="–version, -V"></a>–version, -V</h3><p>打印 grunt 版本。结合 –verbose 一起使用可以获取更多信息。</p>
<h3 id="–completion"><a href="#–completion" class="headerlink" title="–completion"></a>–completion</h3><p>输出 shell 的自动补全规则。更多信息参考 grunt-cli 相关的文档。</p>
<h3 id="–require"><a href="#–require" class="headerlink" title="–require"></a>–require</h3><p>如果你使用默认不支持 Grunt 的语言编写 Gruntfile，请首先指定一个要使用的语言解释器。</p>
</div><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:tty8128@outlook.com">8128</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://8128.me/2020/03/29/Grunt%E6%95%99%E7%A8%8B/">http://8128.me/2020/03/29/Grunt%E6%95%99%E7%A8%8B/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://8128.me" target="_blank">8128's Blog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/tutorial/">tutorial</a><a class="post-meta__tags" href="/tags/code/">code</a><a class="post-meta__tags" href="/tags/javascript/">javascript</a></div><div class="post_share"><div class="social-share" data-image="/img/post.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"/><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js"></script></div></div><div class="post-reward"><a class="reward-button button--primary button--animated"> <i class="fa fa-qrcode"></i> 打赏<div class="reward-main"><ul class="reward-all"><li class="reward-item"><img class="lazyload post-qr-code__img" src="/img/wechat.jpg" alt="微信"/><div class="post-qr-code__desc">微信</div></li><li class="reward-item"><img class="lazyload post-qr-code__img" src="/img/alipay.jpg" alt="支付寶"/><div class="post-qr-code__desc">支付寶</div></li></ul></div></a></div><nav class="pagination_post" id="pagination"><div class="prev-post pull_left"><a href="/2020/03/30/Thrustmaster%20T150%E7%AE%80%E8%AF%84/"><img class="prev_cover lazyload" data-src="https://raw.githubusercontent.com/8128/PicGo/master/20200330171628.png" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">Thrustmaster T150简评</div></div></a></div><div class="next-post pull_right"><a href="/2020/03/29/MacOS%E5%85%B3%E9%97%AD%E9%BC%A0%E6%A0%87%E5%8A%A0%E9%80%9F/"><img class="next_cover lazyload" data-src="https://raw.githubusercontent.com/8128/PicGo/master/20200329145349.png" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">MacOS关闭鼠标加速</div></div></a></div></nav><div class="relatedPosts"><div class="relatedPosts_headline"><i class="fa fa-fw fa-thumbs-up" aria-hidden="true"></i><span> 相关推荐</span></div><div class="relatedPosts_list"><div class="relatedPosts_item"><a href="/2020/04/10/TypeScript数据结构/" title="TypeScript数据结构"><img class="relatedPosts_cover lazyload"data-src="https://raw.githubusercontent.com/8128/PicGo/master/20200401004938.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2020-04-10</div><div class="relatedPosts_title">TypeScript数据结构</div></div></a></div><div class="relatedPosts_item"><a href="/2020/04/06/JavaScript-Rosie快速上手/" title="JavaScript Rosie快速上手"><img class="relatedPosts_cover lazyload"data-src="https://raw.githubusercontent.com/8128/PicGo/master/20200406155734.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2020-04-06</div><div class="relatedPosts_title">JavaScript Rosie快速上手</div></div></a></div><div class="relatedPosts_item"><a href="/2020/03/30/自学Node.JS笔记/" title="自学Node.JS笔记"><img class="relatedPosts_cover lazyload"data-src="https://raw.githubusercontent.com/8128/PicGo/master/20200321225737.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2020-03-30</div><div class="relatedPosts_title">自学Node.JS笔记</div></div></a></div><div class="relatedPosts_item"><a href="/2020/03/26/JS测试教程/" title="JS测试教程"><img class="relatedPosts_cover lazyload"data-src="https://raw.githubusercontent.com/8128/PicGo/master/20200326135918.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2020-03-26</div><div class="relatedPosts_title">JS测试教程</div></div></a></div><div class="relatedPosts_item"><a href="/2020/03/25/JS异步讲解-Asynchronous JavaScript/" title="JS异步讲解-Asynchronous JavaScript"><img class="relatedPosts_cover lazyload"data-src="https://raw.githubusercontent.com/8128/PicGo/master/20200322203138.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2020-03-25</div><div class="relatedPosts_title">JS异步讲解-Asynchronous JavaScript</div></div></a></div><div class="relatedPosts_item"><a href="/2020/03/22/入门JavaScript笔记/" title="入门JavaScript笔记"><img class="relatedPosts_cover lazyload"data-src="https://raw.githubusercontent.com/8128/PicGo/master/20200322203138.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2020-03-22</div><div class="relatedPosts_title">入门JavaScript笔记</div></div></a></div></div><div class="clear_both"></div></div><hr><div id="post-comment"><div class="comment_headling"><i class="fa fa-comments fa-fw" aria-hidden="true"></i><span> 评论</span></div><div id="disqus_thread"></div><script>var disqus_config = function () {
  this.page.url = 'http://8128.me/2020/03/29/Grunt%E6%95%99%E7%A8%8B/';
  this.page.identifier = '2020/03/29/Grunt教程/';
  this.page.title = 'Grunt教程';
};
(function() { 
  var d = document, s = d.createElement('script');
  s.src = 'https://8128g.disqus.com/embed.js';
  s.setAttribute('data-timestamp', +new Date());
  (d.head || d.body).appendChild(s);
})();
</script></div></article></main><footer id="footer" data-type="color"><div id="footer-wrap"><div class="copyright">&copy;2020 By 8128</div><div class="framework-info"><span>驱动 </span><a href="https://hexo.io" target="_blank" rel="noopener"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 </span><a href="https://github.com/jerryc127/hexo-theme-butterfly" target="_blank" rel="noopener"><span>Butterfly</span></a></div><div class="footer_custom_text">Hi, welcome to my <a href="http://8128.me/">blog</a>!</div></div></footer></div><section class="rightside" id="rightside"><div id="rightside-config-hide"><i class="fa fa-book" id="readmode" title="阅读模式"></i><i class="fa fa-plus" id="font_plus" title="放大字体"></i><i class="fa fa-minus" id="font_minus" title="缩小字体"></i><a class="translate_chn_to_cht" id="translateLink" href="javascript:translatePage();" title="简繁转换" target="_self">繁</a><i class="darkmode fa fa-moon-o" id="darkmode" title="夜间模式"></i></div><div id="rightside-config-show"><div id="rightside_config" title="设置"><i class="fa fa-cog" aria-hidden="true"></i></div><a id="to_comment" href="#post-comment" title="直达评论"><i class="scroll_to_comment fa fa-comments">  </i></a><i class="fa fa-list-ul close" id="mobile-toc-button" title="目录" aria-hidden="true"></i><i class="fa fa-arrow-up" id="go-up" title="回到顶部" aria-hidden="true"></i></div></section><div class="search-dialog" id="local-search"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div></div><hr/><div id="local-search-results"><div id="local-hits"></div><div id="local-stats"><div class="local-search-stats__hr" id="hr"><span>由</span> <a href="https://github.com/wzpan/hexo-generator-search" target="_blank" rel="noopener" style="color:#49B1F5;">hexo-generator-search</a>
 <span>提供支持</span></div></div></div><span class="search-close-button"><i class="fa fa-times"></i></span></div><div class="search-mask"></div><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@latest/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/lazysizes@latest/lazysizes.min.js" async=""></script><script src="/js/search/local-search.js"></script></body></html>
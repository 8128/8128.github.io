---
title: Docker笔记
comments: true
toc: true
toc_number: false
copyright: true
mathjax: false
katex: false
hide: false
date: 2020-04-20 15:50:20
tags: 
	- microservice
	- docker
	- container
	- code
	- tutorial
	- kubernetes
categories: microservice
description:
cover: https://raw.githubusercontent.com/8128/PicGo/master/20200414013618.png
top_img:
keywords:
---

## Creating and Using containers

首先需要强调的是container和VM是完全不相同的概念，container只是os中的一个process而已。你用docker查看所有process，那些process都能在你的系统中直接查看到，尽管会显示为不同的PID

First of all check your docker

```shell
docker version
docker info
```

创造Container的简单实例：

```shell
docker container run --publish 80:80 nginx:latest
```

这个案例中完成了几个步骤：

1. 查询本地cache中有无nginx image
2. 从docker hub上下载了最新版本的image 'nginx'
3. 以这个image生成了一个新的container，并run了这个container
4. 给了container一个docker engine内部的private network virtual ip
5. 打开了host ip的80端口
6. 将所有流量导向了container的ip，80端口
7. container开始运行dockerfile中的CMD内容

假如我们在命令中添加 `--detach`即可让docker在后台运行。这时你会获取到一个ID，这是每个container都会有的id。

假如你想查看containers（默认只显示运行的），使用

```shell
docker container ls
```

这时候显示的`container id`一般是完整的id的前几位。你可以通过这个简短的id对container进行控制，甚至可以使用仅仅前几位，比如前三位。比方说我们在关闭该container

```shell
docker container stop 690
```

显示所有container：

```shell
docker container ls -a
```

你会留意到最右侧的`NAMES`下有一堆奇葩的名字，这些名字实际上是docker帮你随机生成的。docker中name需要unique，所以会给你生成一堆乱七八糟不一样的花名。假如你想用自己的名字来方便操作，你可以在container声明的时候声明一个name，比如：

```shell
docker container run --publish 80:80 --detach --name webhost nginx
```

这样生成的container名字就会被叫做webhost。在这种情况下你可以用名字控制这个container了，比如你现在想查看这个container的log:

```shell
docker container logs webhost
```

比如你想查看在你container中运行的process:

```shell
docker container top webhost
```

假如我要删除container，你需要先关闭正在running的target，或者在命令中添加force（`-f`）。你可以选择同时删除多个container，我们取它的id：

```shell
docker container rm 62f 690 ode
```

这样ID以62f，690，ode开头的三个container就会被删除。

使用`--env yourEnv`可以让你传入environment变量

### 查看运行状况

```shell
docker container top # process list in one container
docker container inspect # details of one container config
docker container stats # performance stats for all containers
```

### 进入container进行shell操作

其实无需SSH，我们就能直接获取container内部的shell


---
layout: post
title:  自学Node.JS笔记
date:   2020-03-30 19:56:00
description: 前后端兼备的语言
subtitle: 
comments: true
cover: https://raw.githubusercontent.com/8128/PicGo/master/20200321225737.png
optimized_image: 
category: javascript
tags:
  - tutorial
  - code
  - javascript
  - node
author: tty
hide: false
---

因为工作原因，我需要学习Node.JS。作为一个在JavaScript上毫无建树的人，我只能从头学起。这是我的学习笔记。

来源：Udemy Course：The complete node.js developer course (3rd edition)

这门课有个pdf，我看到哪就会记到哪。这门课的内容也都比较基础，不建议有js基础的人看。pdf下载[传送门](https://github.com/8128/LC-solution/raw/master/test/src/com/node.pdf)

# 关于npm

就是个package管理系统，类似于java中maven的东西，使用`npm init`会初始化一个项目，自动新建一个`package.json`文件和一个`package-lock.json`文件。注意，你永远不应该编辑后者，因为那是根据前者自动生成的文件。使用`npm install`的包都会被记录到`package.json`里。假如你用`npm install -g`安装则会装到你系统环境里，不会显示到`package.json` file

在安装了本地依赖后，依赖会出现在`node_modules`文件夹下。但凡是npm安装的module，你都可以直接用`require('module name')`的方式来导入。比如`validator.js`作为依赖导入后，他的module名为`validator`，因此只需要`requre('validator.js')`即可

## 很有用的nodemon

```shell
npm install nodemon -g
```

能自动读取你对文件的改变并在console输出。

# 基础输入输出

`process.argv`可以获取到用户的所有输入。例如`node app.js Andrew`，利用它可以获取到长度为3的array，第一个为你的node路径，第二个为app.js路径，第三个为Andrew。

## 利用Yargs

```shell
npm install yargs
```

建议直接用`yargs --help`

### Simple Example

```js
#!/usr/bin/env node
const argv = require('yargs').argv
 
if (argv.ships > 3 && argv.distance < 53.5) {
  console.log('Plunder more riffiwobbles!')
} else {
  console.log('Retreat from the xupptumblers!')
}
```

```shell
$ ./plunder.js --ships=4 --distance=22
Plunder more riffiwobbles!
 
$ ./plunder.js --ships 12 --distance 98.7
Retreat from the xupptumblers!
```

### Complex Example

```js
#!/usr/bin/env node
require('yargs') // eslint-disable-line
  .command('serve [port]', 'start the server', (yargs) => {
    yargs
      .positional('port', {
        describe: 'port to bind on',
        default: 5000
      })
  }, (argv) => {
    if (argv.verbose) console.info(`start server on :${argv.port}`)
    serve(argv.port)
  })
  .option('verbose', {
    alias: 'v',
    type: 'boolean',
    description: 'Run with verbose logging'
  })
  .argv
```

Run the example above with `--help` to see the help for the application.

# 代码风格

变量遵循驼峰命名

$ dollar sign开头的函数一般表示getter setter

_ lowdash 开头一般表示对数据库的操作

# 异步

## async

传送门：[async doc](https://caolan.github.io/async/v3/)

这是一个nodejs库

#### waterfall(tasks, callback*opt*)

有两种用法。因为有两个输入，所以你可以在第一个输入中只写函数名，第二个cb中写详细函数功能。第二个用法就是在第一个输入中就把所有task写完整

Runs the `tasks` array of functions in series, each passing their results to the next in the array. However, if any of the `tasks` pass an error to their own callback, the next function is not executed, and the main `callback` is immediately called with the error.

##### Parameters:

| Name       | Type                | Description                                                  |
| :--------- | :------------------ | :----------------------------------------------------------- |
| `tasks`    | Array               | An array of [async functions](https://caolan.github.io/async/v3/global.html) to run. Each function should complete with any number of `result` values. The `result` values will be passed as arguments, in order, to the next task. |
| `callback` | function <optional> | An optional callback to run once all the functions have completed. This will be passed the results of the last task's callback. Invoked with (err, [results]). |

##### Returns:

undefined

##### Example

```js
async.waterfall([
    function(callback) {
        callback(null, 'one', 'two');
    },
    function(arg1, arg2, callback) {
        // arg1 now equals 'one' and arg2 now equals 'two'
        callback(null, 'three');
    },
    function(arg1, callback) {
        // arg1 now equals 'three'
        callback(null, 'done');
    }
], function (err, result) {
    // result now equals 'done'
});

// Or, with named functions:
async.waterfall([
    myFirstFunction,
    mySecondFunction,
    myLastFunction,
], function (err, result) {
    // result now equals 'done'
});
function myFirstFunction(callback) {
    callback(null, 'one', 'two');
}
function mySecondFunction(arg1, arg2, callback) {
    // arg1 now equals 'one' and arg2 now equals 'two'
    callback(null, 'three');
}
function myLastFunction(arg1, callback) {
    // arg1 now equals 'three'
    callback(null, 'done');
}
```